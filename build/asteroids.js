!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/build/",t(0)}([function(e,t,n){"use strict";var i,o=n(1),r=n(2),s=n(3),a=n(6),u=n(9),d=n(12),l=n(7),h=n(15),c=n(13),p=15;!function(e){e[e.Attract=0]="Attract",e[e.Game=1]="Game",e[e.Initials=2]="Initials",e[e.Start=3]="Start"}(i||(i={}));var f=function(){function e(){this.lastScore=0,this.init()}return e.prototype.init=function(e){var t=this;c.Sound.off(),this.mode=i.Start,this.highScoreMode=new s.HighScoreMode(this.lastScore),this.attractMode=new u.AttractMode(e||new h.State(r.highscores.top.score)),this.gameMode=new d.GameMode(new h.State(r.highscores.top.score)),this.attractTimer=0,this.gameMode.on("done",function(e,n){t.lastScore=n.score,r.highscores.qualifies(n.score)?(t.initialsMode=new a.InitialsMode(n.score),t.initialsMode.on("done",function(){t.init(n)}),c.Sound.off(),t.mode=i.Initials):t.init(n)}),this.attractStarted=!1},e.prototype.update=function(e){switch(this.mode){case i.Start:this.highScoreMode.update(e),this.attractStarted&&this.attractMode.update(e),l.Key.isPressed(l.Key.ONE)?(c.Sound.on(),this.mode=i.Game):this.updateAttractTimer(e);break;case i.Attract:this.attractMode.update(e),l.Key.isPressed(l.Key.ONE)?(c.Sound.on(),this.mode=i.Game):this.updateAttractTimer(e);break;case i.Initials:this.initialsMode.update(e);break;case i.Game:this.gameMode.update(e)}},e.prototype.render=function(e){switch(this.mode){case i.Start:this.highScoreMode.render(e);break;case i.Attract:this.attractMode.render(e);break;case i.Initials:this.initialsMode.render(e);break;case i.Game:this.gameMode.render(e)}l.Key.update()},e.prototype.updateAttractTimer=function(e){this.attractTimer+=e,this.attractTimer>=p&&(this.attractTimer=0,this.mode=this.mode===i.Attract?i.Start:i.Attract,this.mode===i.Attract?c.Sound.on():c.Sound.off())},e}();t.Asteroids=f;var _=new f;setTimeout(function(){o.loop(_)},1e3)},function(e,t){"use strict";var n,i=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},o=0,r=i(),s=1/60,a=1e3,u=function(e){var t=function(){for(n=i(),o+=Math.min(1,(n-r)/a);o>s;)e.update(s),o-=s;e.render(o),r=n,requestAnimationFrame(t)};t()};t.loop=function(e){u(e)}},function(e,t){"use strict";var n=[{score:20140,initials:"J H"},{score:20050,initials:"P A"},{score:19930,initials:"  M"},{score:19870,initials:"G I"},{score:19840,initials:"A L"},{score:19790,initials:"M T"},{score:19700,initials:"E O"},{score:19660,initials:"S N"},{score:190,initials:"   "},{score:70,initials:"   "}],i="jph_asteroids_hs",o=function(){function e(){this.scores=[];var e=window.localStorage.getItem(i);this.scores=e?JSON.parse(e)||[]:n}return Object.defineProperty(e.prototype,"top",{get:function(){return this.scores[0]},enumerable:!0,configurable:!0}),e.prototype.qualifies=function(e){var n=t.highscores.scores.filter(function(t){return t.score<e});return!!n.length},e.prototype.save=function(e,t){this.qualifies(e)&&(this.scores.push({score:e,initials:t}),this.scores=this.scores.sort(function(e,t){return e.score>t.score?-1:1}).slice(0,10),window.localStorage.setItem(i,JSON.stringify(this.scores)))},e}();t.highscores=new o},function(e,t,n){"use strict";var i=n(4),o=n(2),r=function(){function e(e){this.score=e,this.blink=0,this.showPushStart=!0,this.highscore=o.highscores.top.score}return e.prototype.update=function(e){this.blink+=e,this.blink>=.4&&(this.blink=0,this.showPushStart=!this.showPushStart)},e.prototype.render=function(){this.drawBackground(),this.drawPushStart(),this.drawHighScores()},e.prototype.drawBackground=function(){i.default.draw.background(),i.default.draw.scorePlayer1(this.score),i.default.draw.oneCoinOnePlay(),i.default.draw.highscore(this.highscore),i.default.draw.copyright()},e.prototype.drawHighScores=function(){var e=i.default.width/2;i.default.draw.text2("high scores","30pt",function(t){return{x:e-t/2,y:200}});for(var t=function(t){var r=280+40*t,s=n.pad(t+1," ",2)+"."+n.pad(o.highscores.scores[t].score," ",6)+" "+o.highscores.scores[t].initials;i.default.draw.text2(s,"30pt",function(t){return{x:e-t/2,y:r}})},n=this,r=0;r<o.highscores.scores.length;r++)t(r)},e.prototype.drawPushStart=function(){this.showPushStart&&i.default.draw.pushStart()},e.prototype.pad=function(e,t,n){for(e=e.toString();e.length<n;)e=t+e;return e},e}();t.HighScoreMode=r},function(e,t,n){"use strict";var i=n(5),o=function(){function e(){var e=this;this.x=0,this.y=0,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.draw=new i.Draw(this.ctx),this.init(),window.addEventListener("resize",function(){e.init()})}return e.prototype.init=function(){this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.width=this.canvas.width,this.height=this.canvas.height,this.width2=this.width/2,this.height2=this.height/2},e}();t.Screen=o,Object.defineProperty(t,"__esModule",{value:!0}),t.default=new o},function(e,t,n){"use strict";var i=n(4),o="rgba(255,255,255,1)",r=function(){function e(e){this.ctx=e}return e.prototype.line=function(e,t,n,i){void 0===n&&(n=o),void 0===i&&(i=2);var r=this.ctx;r.beginPath(),r.strokeStyle=n,r.lineWidth=i,r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.closePath()},e.prototype.shape=function(e,t,n,i){void 0===i&&(i=o);for(var r,s,a=0;a<e.length-1;a++)r={x:t+e[a].x,y:n+e[a].y},s={x:t+e[a+1].x,y:n+e[a+1].y},this.line(r,s,i,2)},e.prototype.rect=function(e,t,n){void 0===n&&(n=o);var i=this.ctx;i.beginPath(),i.fillStyle=n,i.fillRect(e.x,e.y,t.x,t.y),i.stroke(),i.closePath()},e.prototype.point=function(e,t){void 0===t&&(t=o),this.rect(e,{x:4,y:4},t)},e.prototype.background=function(){this.rect({x:0,y:0},{x:i.default.width,y:i.default.height},"#000000")},e.prototype.bounds=function(e,t){void 0===t&&(t=o);var n=this.ctx;e&&(n.save(),n.beginPath(),n.strokeStyle=t,n.lineWidth=2,n.moveTo(e.x,e.y),n.lineTo(e.x+e.width,e.y),n.lineTo(e.x+e.width,e.y+e.height),n.lineTo(e.x,e.y+e.height),n.lineTo(e.x,e.y),n.stroke(),n.closePath(),n.restore())},e.prototype.text=function(e,t,n,i){var r=this.ctx;r.save(),r.font=i+" hyperspace",r.textBaseline="middle",r.lineWidth=1,r.strokeStyle=o,r.strokeText(e,t,n),r.restore()},e.prototype.text2=function(e,t,n){var i=this.ctx;i.save(),i.font=t+" hyperspace",i.textBaseline="middle",i.lineWidth=1,i.strokeStyle=o;var r=i.measureText(e).width,s=n(r);i.strokeText(e,s.x,s.y),i.restore()},e.prototype.text3=function(e,t,n){var i=this.ctx;i.save(),i.font=t+" hyperspace",i.textBaseline="middle",i.lineWidth=2,i.fillStyle=o;var r=i.measureText(e).width,s=n(r);i.fillText(e,s.x,s.y),i.restore()},e.prototype.scorePlayer1=function(e){for(var t=e.toString();t.length<2;)t="0"+t;this.text(t,100,20,"24pt")},e.prototype.highscore=function(e){for(var t=e.toString();t.length<2;)t="0"+t;this.text2(t,"12pt",function(e){return{x:i.default.width2-e/2,y:20}})},e.prototype.oneCoinOnePlay=function(){this.text2("1  coin  1  play","24pt",function(e){return{x:i.default.width2-e/2,y:i.default.height-120}})},e.prototype.pushStart=function(){i.default.draw.text2("push start","30pt",function(e){return{x:i.default.width2-e/2,y:120}})},e.prototype.player1=function(){i.default.draw.text2("player 1","30pt",function(e){return{x:i.default.width2-e/2,y:140}})},e.prototype.gameOver=function(){i.default.draw.text2("game over","30pt",function(e){return{x:i.default.width2-e/2,y:180}})},e.prototype.copyright=function(){this.text2(String.fromCharCode(169)+" 1979 atari inc","12pt",function(e){return{x:i.default.width2-e/2,y:i.default.height-20}})},e}();t.Draw=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(4),r=n(7),s=n(2),a=n(8),u="_abcdefghijklmnopqrstuvwxyz",d=function(e){function t(t){var n=e.call(this)||this;return n.index=1,n.score=t,n.init(),n}return i(t,e),t.prototype.init=function(){this.position=0,this.index=1,this.initials=["a","_","_"]},t.prototype.update=function(e){r.Key.isPressed(r.Key.LEFT)&&(this.index--,this.index<0&&(this.index=u.length-1),this.initials[this.position]=u[this.index]),r.Key.isPressed(r.Key.RIGHT)&&(this.index++,this.index>u.length-1&&(this.index=0),this.initials[this.position]=u[this.index]),r.Key.isPressed(r.Key.SPACE)&&(this.position++,this.position>=3&&(console.log(this.score,this.initials.join("")),s.highscores.save(this.score,this.initials.join("")),this.init(),this.trigger("done")),this.index=1,this.initials[this.position]=u[this.index])},t.prototype.render=function(){var e=165,t=function(t){return o.default.draw.text(t,50,e+=35,"30pt")};o.default.draw.background(),o.default.draw.highscore(s.highscores.top.score),o.default.draw.scorePlayer1(this.score),o.default.draw.copyright(),t("your score is one of the ten best"),t("please enter your initials"),t("push rotate to select letter"),t("push hyperspace when letter is correct"),o.default.draw.text3(this.initials.join(""),"60pt",function(e){return{x:o.default.width/2-e,y:o.default.height/2}})},t}(a.EventSource);t.InitialsMode=d},function(e,t){"use strict";var n=222,i=function(){function e(){var e=this;this.SPACE=32,this.LEFT=37,this.UP=38,this.RIGHT=39,this.SHIFT=16,this.CTRL=17,this.ONE=49,this.DEBUG=68,this.PAUSE=80,this.keys=new Array(n),this.prev=new Array(n);for(var t=0;t<n;t++)this.keys[t]=this.prev[t]=!1;window.onkeydown=function(t){e.keys[t.keyCode]=!0},window.onkeyup=function(t){e.keys[t.keyCode]=!1}}return e.prototype.update=function(){for(var e=0;e<n;e++)this.prev[e]=this.keys[e]},e.prototype.isPressed=function(e){return this.prev[e]===!1&&this.keys[e]===!0},e.prototype.wasPressed=function(e){return this.prev[e]&&!this.keys[e]},e.prototype.isDown=function(e){return this.keys[e]},e}();t._Key=i,t.Key=new i},function(e,t){"use strict";var n=function(){function e(){this.handlers={}}return e.prototype.on=function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},e.prototype.off=function(e,t){this.handlers[e]=this.handlers[e].filter(function(e){return e!==t})},e.prototype.trigger=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=this.handlers[e]||[];o.forEach(function(e){return e.apply(void 0,[t].concat(n))})},e}();t.EventSource=n},function(e,t,n){"use strict";var i=n(4),o=n(10),r=function(){function e(e){this.state=e,this.showPushStart=!0,this.pushStartTimer=0,this.init()}return e.prototype.init=function(){this.state.started||this.state.startLevel()},e.prototype.update=function(e){this.state.levelTimer+=e,this.state.updateAlienTimer(e),this.state.rocks.length||this.state.explosions.length||this.state.alien||this.state.startLevel(),this.updatePushStartTimer(e),this.checkCollisions(),this.state.objects.forEach(function(t){t&&t.update(e)})},e.prototype.updatePushStartTimer=function(e){this.pushStartTimer+=e,this.pushStartTimer>=.4&&(this.pushStartTimer=0,this.showPushStart=!this.showPushStart)},e.prototype.checkCollisions=function(){var e=this,t=this.state,n=t.alien,i=t.rocks,r=t.alienBullets,s=!!n||!!r.length;if(s){var a=new o.Collisions;a.check([n],i,function(t,n){e.state.alienDestroyed(),e.state.rockDestroyed(n)}),a.check(r,i,function(t,n){e.state.rockDestroyed(n)})}},e.prototype.render=function(){this.drawBackground(),this.drawPushStart(),this.state.objects.forEach(function(e){e&&e.render()})},e.prototype.drawBackground=function(){i.default.draw.background(),i.default.draw.scorePlayer1(this.state.score),i.default.draw.oneCoinOnePlay(),i.default.draw.highscore(this.state.highscore),i.default.draw.copyright()},e.prototype.drawPushStart=function(){this.showPushStart&&i.default.draw.pushStart()},e}();t.AttractMode=r},function(e,t,n){"use strict";var i=n(4),o=n(11),r=function(){function e(){this.tree=new o.Quadtree({x:0,y:0,width:i.default.width,height:i.default.height},1)}return e.prototype.check=function(e,t,n,i){var o=this;e&&e.length&&t&&t.length&&(this.tree.clear(),t.forEach(function(e){o.tree.insert(e)}),e.forEach(function(e){var t=[];t.push.apply(t,o.tree.retrieve(e)),t.forEach(function(t){t.collided(e)?o.pointsInPolygon(e,t)&&n(e,t):i&&i(e,t)})}))},e.prototype.pointsInPolygon=function(e,t){for(var n=e.vertices,i=t.vertices,o=0,r=i.length;o<r;o++)if(this.pointInPoly(n,i[o]))return!0;return!1},e.prototype.pointInPoly=function(e,t){for(var n=e.length-1,i=0,o=0,r=e.length;o<r;o++)(e[o].y<t.y&&e[n].y>=t.y||e[n].y<t.y&&e[o].y>=t.y)&&(e[o].x<=t.x||e[n].x<=t.x)&&(i^=e[o].x+(t.y-e[o].y)/(e[n].y-e[o].y)*(e[n].x-e[o].x)<t.x),n=o;return i%2===0},e}();t.Collisions=r},function(e,t){"use strict";var n=function(){function e(e,t,n,i){void 0===t&&(t=10),void 0===n&&(n=4),void 0===i&&(i=0),this.bounds=e,this.maxObjects=t,this.maxLevels=n,this.level=i,this.objects=[],this.nodes=[],this.width2=this.bounds.width/2,this.height2=this.bounds.height/2,this.xmid=this.bounds.x+this.width2,this.ymid=this.bounds.y+this.height2}return e.prototype.insert=function(e){var t=this;if(e){var n,i=0;if(this.nodes.length&&(n=this.getIndex(e),n.length))return void n.forEach(function(n){t.nodes[n].insert(e)});if(this.objects.push(e),this.objects.length>this.maxObjects&&this.level<this.maxLevels){this.nodes.length||this.split();for(var o=function(){if(n=r.getIndex(r.objects[i]),n.length){var e=r.objects.splice(i,1)[0];n.forEach(function(n){t.nodes[n].insert(e)})}else i+=1},r=this;i<this.objects.length;)o()}}},e.prototype.retrieve=function(e){var t=this;if(!e)return[];var n=this.getIndex(e),i=this.objects;if(this.nodes.length)if(n.length)n.forEach(function(n){i=i.concat(t.nodes[n].retrieve(e))});else for(var o=0;o<this.nodes.length;o++)i=i.concat(this.nodes[o].retrieve(e));return i.filter(function(e,t,n){return n.indexOf(e)===t})},e.prototype.clear=function(){this.objects=[];for(var e=0;e<this.nodes.length;e++)this.nodes[e]&&this.nodes[e].clear();this.nodes=[]},e.prototype.getIndex=function(e){if(!e)return[];var t=[],n=this,i=n.xmid,o=n.ymid,r=e.y<=o,s=e.y>o;if(e.x<=i)if(r){t.push(1);var a=!1;e.x+e.width>i&&(t.push(0),a=!0),e.y+e.height>o&&(t.push(2),a&&t.push(3))}else s&&(t.push(2),e.x+e.width>i&&t.push(3));else e.x>i&&(r?(t.push(0),e.y+e.height>o&&t.push(3)):t.push(3));return t},e.prototype.split=function(){var t=this,n=Math.round(this.width2),i=Math.round(this.height2),o=Math.round(this.bounds.x),r=Math.round(this.bounds.y),s=function(o,r){var s={x:o,y:r,width:n,height:i};return new e(s,t.maxObjects,t.maxLevels,t.level+1)};this.nodes=[s(o+n,r),s(o,r),s(o,r+i),s(o+n,r+i)]},e}();t.Quadtree=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(7),r=n(8),s=n(10),a=n(4),u=n(13),d=function(){function e(){this.reset()}return e.prototype.reset=function(){this.thumpBeatTimer=0,this.thumpBeat=1,this.thumpTimer=0,this.thumpTime=10,this.lo=!0,this.max=!1},e.prototype.update=function(e){this.thumpTimer+=e,this.thumpBeatTimer+=e,this.thumpBeatTimer>=this.thumpBeat&&(this.lo?u.thumpLo.play():u.thumpHi.play(),this.lo=!this.lo,this.thumpBeatTimer=0),!this.max&&this.thumpTimer>=this.thumpTime&&(this.thumpBeat-=.2,this.thumpBeat<=.2&&(this.thumpBeat=.2,this.max=!0),this.thumpTimer=0)},e}(),l=function(e){function t(t){var n=e.call(this)||this;return n.state=t,n.debug=!1,n.bounds=[],n}return i(t,e),t.prototype.init=function(){this.state.addShip(a.default.width2,a.default.height2),this.state.startLevel(),this.thumper=new d},t.prototype.update=function(e){if(o.Key.isPressed(o.Key.DEBUG)&&(this.debug=!this.debug),o.Key.isPressed(o.Key.PAUSE)&&(this.state.paused=!this.state.paused),o.Key.isPressed(o.Key.SPACE)&&this.state.hyperspace(),!this.state.paused){if(this.state.levelTimer+=e,this.thumper&&this.state.ship&&this.thumper.update(e),this.state.gameOver&&(this.state.gameOverTimer+=e,this.state.gameOverTimer>=5&&this.trigger("done",this.state)),!this.state.started)return void(this.state.levelTimer>=2&&(this.init(),this.state.started=!0));this.state.updateAlienTimer(e),this.state.gameOver||(this.state.shouldTryToPlaceShip()&&this.state.tryPlaceShip(e),this.state.shouldCheckForNextLevel()&&(this.state.startLevel(),this.thumper.reset())),this.state.lives||(this.state.gameOver=!0),this.checkCollisions(),this.state.objects.forEach(function(t){t&&t.update(e)})}},t.prototype.render=function(e){this.renderStatic(),this.state.objects.forEach(function(e){e&&e.render()})},t.prototype.renderStatic=function(){a.default.draw.background(),a.default.draw.copyright(),a.default.draw.scorePlayer1(this.state.score),a.default.draw.highscore(this.state.highscore),this.state.drawExtraLives(),this.state.started||a.default.draw.player1(),this.state.gameOver&&a.default.draw.gameOver(),this.debug&&this.renderDebug()},t.prototype.renderDebug=function(){if(a.default.draw.text2("debug mode","12pt",function(e){return{x:a.default.width-e-10,y:a.default.height-40}}),this.bounds&&this.bounds.forEach(function(e){a.default.draw.bounds(e,"#fc058d")}),!this.state.ship&&this.state.lives){var e={x:a.default.width2-120,y:a.default.height2-120,width:240,height:240};a.default.draw.bounds(e,"#00ff00")}this.state.ship&&a.default.draw.text(this.state.ship.angle.toString(),this.state.ship.origin.x+20,this.state.ship.origin.y+20,"10pt");var t=new Date(null);t.setSeconds(this.state.levelTimer),a.default.draw.text2(t.toISOString().substr(11,8),"12pt",function(e){return{x:10,y:a.default.height-40}})},t.prototype.checkCollisions=function(){var e=this,t=this.state,n=t.ship,i=t.rocks,o=t.shipBullets,r=t.alien,a=t.alienBullets;if(this.state.shouldCheckCollisions()){this.bounds=[];var u=new s.Collisions;u.check([n],i,function(t,n){e.state.addScore(n.score),e.state.rockDestroyed(n),e.state.shipDestroyed()},function(t,n){e.debug&&e.bounds.push(n)}),u.check(o,i,function(t,n){e.state.addScore(n.score),e.state.rockDestroyed(n),t.destroy()},function(t,n){e.debug&&e.bounds.push(n)}),u.check(o,[r],function(t,n){e.state.addScore(n.score),e.state.alienDestroyed(),t.destroy()},function(t,n){e.debug&&e.bounds.push(n)}),u.check([n],[r],function(t,n){e.state.addScore(n.score),e.state.alienDestroyed(),e.state.shipDestroyed()},function(t,n){e.debug&&e.bounds.push(n)}),u.check(a,i,function(t,n){e.state.rockDestroyed(n)},function(t,n){e.debug&&e.bounds.push(n)}),u.check(a,[n],function(t,n){e.state.shipDestroyed(),t.destroy()},function(t,n){e.debug&&e.bounds.push(n)}),u.check([r],i,function(t,n){e.state.alienDestroyed(),e.state.rockDestroyed(n)},function(t,n){e.debug&&e.bounds.push(n)})}},t}(r.EventSource);t.GameMode=l},function(e,t,n){"use strict";function i(e){var n=new o.Howl(e),i=n.play.bind(n);return n.play=function(){s&&i()},n._origVolume=e.volume,t.all.push(n),n}var o=n(14),r=.5,s=!0;t.all=[],t.fire=i({src:["./assets/fire.wav"],volume:r}),t.thrust=i({src:["./assets/thrust.wav"],volume:.4}),t.alienFire=i({src:["./assets/sfire.wav"],volume:r}),t.largeExplosion=i({src:["./assets/explode1.wav"],volume:r}),t.mediumExplosion=i({src:["./assets/explode2.wav"],volume:r}),t.smallExplosion=i({src:["./assets/explode3.wav"],volume:r}),t.largeAlien=i({src:["./assets/lsaucer.wav"],volume:r,loop:!0}),t.thumpLo=i({src:["./assets/thumplo.wav"],volume:1}),t.thumpHi=i({src:["./assets/thumphi.wav"],volume:1}),t.extraLife=i({src:["./assets/life.wav"],volume:.5}),t.Sound={on:function(){s=!0,t.all.forEach(function(e){return e.volume(e._origVolume)})},off:function(){s=!1,t.all.forEach(function(e){return e.volume(0)})}}},function(e,t,n){var i,o;(function(n){!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var e=this||s;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||f(),"undefined"!=typeof e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&(t.masterGain.gain.value=e);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||f(),t._muted=e,t.usingWebAudio&&(t.masterGain.gain.value=e?0:t._volume);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&"undefined"!=typeof e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;"undefined"==typeof t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),o=i&&parseInt(i[0].split("/")[1],10)<33;return e._codecs={mp3:!(o||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||s,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),n=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||n)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var i=function(){var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),"undefined"==typeof t.start?t.noteOn(0):t.start(0),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",i,!0)}};return document.addEventListener("touchend",i,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&"undefined"!=typeof e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&"undefined"!=typeof e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.state="resuming",e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new r,a=function(e){var t=this;return e.src&&0!==e.src.length?void t.init(e):void console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return s.ctx||f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,"undefined"!=typeof s.ctx&&s.ctx&&s.mobileAutoEnable&&s._enableMobileAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(s.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var i,o;if(e._format&&e._format[n])i=e._format[n];else{if(o=e._src[n],"string"!=typeof o){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}i=/^data:audio\/([^;,]+);/i.exec(o),i||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(s.codecs(i)){t=e._src[n];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new u(e),e._webAudio&&l(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var n=this,i=null;if("number"==typeof e)i=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if("undefined"==typeof e){e="__default";for(var o=0,r=0;r<n._sounds.length;r++)n._sounds[r]._paused&&!n._sounds[r]._ended&&(o++,i=n._sounds[r]._id);1===o?e=null:i=null}}var a=i?n._soundById(i):n._inactiveSound();if(!a)return null;if(i&&!e&&(e=a._sprite||"__default"),"loaded"!==n._state&&!n._sprite[e])return n._queue.push({event:"play",action:function(){n.play(n._soundById(a._id)?a._id:void 0)}}),a._id;if(i&&!a._paused)return t||setTimeout(function(){n._emit("play",a._id)},0),a._id;n._webAudio&&s._autoResume();var u=Math.max(0,a._seek>0?a._seek:n._sprite[e][0]/1e3),d=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-u),l=1e3*d/Math.abs(a._rate);a._paused=!1,a._ended=!1,a._sprite=e,a._seek=u,a._start=n._sprite[e][0]/1e3,a._stop=(n._sprite[e][0]+n._sprite[e][1])/1e3,a._loop=!(!a._loop&&!n._sprite[e][2]);var h=a._node;if(n._webAudio){var c=function(){n._refreshBuffer(a);var e=a._muted||n._muted?0:a._volume;h.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,"undefined"==typeof h.bufferSource.start?a._loop?h.bufferSource.noteGrainOn(0,u,86400):h.bufferSource.noteGrainOn(0,u,d):a._loop?h.bufferSource.start(0,u,86400):h.bufferSource.start(0,u,d),l!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l)),t||setTimeout(function(){n._emit("play",a._id)},0)},p="running"===s.state;"loaded"===n._state&&p?c():(n.once(p?"load":"resume",c,p?a._id:null),n._clearTimer(a._id))}else{var f=function(){h.currentTime=u,h.muted=a._muted||n._muted||s._muted||h.muted,h.volume=a._volume*s.volume(),h.playbackRate=a._rate,setTimeout(function(){h.play(),l!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l)),t||n._emit("play",a._id)},0)},_="loaded"===n._state&&(window&&window.ejecta||!h.readyState&&s._navigator.isCocoonJS);if(4===h.readyState||_)f();else{var y=function(){f(),h.removeEventListener(s._canPlayEvent,y,!1)};h.addEventListener(s._canPlayEvent,y,!1),n._clearTimer(a._id)}}return a._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused&&(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node))if(t._webAudio){if(!o._node.bufferSource)return t;"undefined"==typeof o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var r=n._soundById(i[o]);if(r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,n._stopFade(i[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)return t||n._emit("stop",r._id),n;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause());r&&!t&&n._emit("stop",r._id)}return n},mute:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if("undefined"==typeof t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var i=n._getSoundIds(t),o=0;o<i.length;o++){var r=n._soundById(i[o]);r&&(r._muted=e,n._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),n._emit("mute",r._id))}return n},volume:function(){var e,t,n=this,i=arguments;if(0===i.length)return n._volume;if(1===i.length||2===i.length&&"undefined"==typeof i[1]){var o=n._getSoundIds(),r=o.indexOf(i[0]);r>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10));var a;if(!("undefined"!=typeof e&&e>=0&&e<=1))return a=t?n._soundById(t):n._sounds[0],a?a._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,i)}}),n;"undefined"==typeof t&&(n._volume=e),t=n._getSoundIds(t);for(var u=0;u<t.length;u++)a=n._soundById(t[u]),a&&(a._volume=e,i[2]||n._stopFade(t[u]),n._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,s.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*s.volume()),n._emit("volume",a._id));return n},fade:function(e,t,n,i){var o=this,r=Math.abs(e-t),a=e>t?"out":"in",u=r/.01,d=u>0?n/u:n;if(d<4&&(u=Math.ceil(u/(4/d)),d=4),"loaded"!==o._state)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,i)}}),o;o.volume(e,i);for(var l=o._getSoundIds(i),h=0;h<l.length;h++){var c=o._soundById(l[h]);if(c){if(i||o._stopFade(l[h]),o._webAudio&&!c._muted){var p=s.ctx.currentTime,f=p+n/1e3;c._volume=e,c._node.gain.setValueAtTime(e,p),c._node.gain.linearRampToValueAtTime(t,f)}var _=e;c._interval=setInterval(function(e,n){u>0&&(_+="in"===a?.01:-.01),_=Math.max(0,_),_=Math.min(1,_),_=Math.round(100*_)/100,o._webAudio?("undefined"==typeof i&&(o._volume=_),n._volume=_):o.volume(_,e,!0),_===t&&(clearInterval(n._interval),n._interval=null,o.volume(_,e),o._emit("fade",e))}.bind(o,l[h],c),d)}}return o},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),
clearInterval(n._interval),n._interval=null,t._emit("fade",e)),t},loop:function(){var e,t,n,i=this,o=arguments;if(0===o.length)return i._loop;if(1===o.length){if("boolean"!=typeof o[0])return n=i._soundById(parseInt(o[0],10)),!!n&&n._loop;e=o[0],i._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var r=i._getSoundIds(t),s=0;s<r.length;s++)n=i._soundById(r[s]),n&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return i},rate:function(){var e,t,n=this,i=arguments;if(0===i.length)t=n._sounds[0]._id;else if(1===i.length){var o=n._getSoundIds(),r=o.indexOf(i[0]);r>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));var a;if("number"!=typeof e)return a=n._soundById(t),a?a._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,i)}}),n;"undefined"==typeof t&&(n._rate=e),t=n._getSoundIds(t);for(var u=0;u<t.length;u++)if(a=n._soundById(t[u])){a._rateSeek=n.seek(t[u]),a._playStart=n._webAudio?s.ctx.currentTime:a._playStart,a._rate=e,n._webAudio&&a._node&&a._node.bufferSource?a._node.bufferSource.playbackRate.value=e:a._node&&(a._node.playbackRate=e);var d=n.seek(t[u]),l=(n._sprite[a._sprite][0]+n._sprite[a._sprite][1])/1e3-d,h=1e3*l/Math.abs(a._rate);!n._endTimers[t[u]]&&a._paused||(n._clearTimer(t[u]),n._endTimers[t[u]]=setTimeout(n._ended.bind(n,a),h)),n._emit("rate",a._id)}return n},seek:function(){var e,t,n=this,i=arguments;if(0===i.length)t=n._sounds[0]._id;else if(1===i.length){var o=n._getSoundIds(),r=o.indexOf(i[0]);r>=0?t=parseInt(i[0],10):(t=n._sounds[0]._id,e=parseFloat(i[0]))}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("undefined"==typeof t)return n;if("loaded"!==n._state)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var a=n._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var u=n.playing(t)?s.ctx.currentTime-a._playStart:0,d=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(d+u*Math.abs(a._rate))}return a._node.currentTime}var l=n.playing(t);l&&n.pause(t,!0),a._seek=e,a._ended=!1,n._clearTimer(t),l&&n.play(t,!0),!n._webAudio&&a._node&&(a._node.currentTime=e),n._emit("seek",t)}return n},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++){t[n]._paused||(e.stop(t[n]._id),e._emit("end",t[n]._id)),e._webAudio||(t[n]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(s._canPlayEvent,t[n]._loadFn,!1)),delete t[n]._node,e._clearTimer(t[n]._id);var i=s._howls.indexOf(e);i>=0&&s._howls.splice(i,1)}var o=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===e._src){o=!1;break}return d&&o&&delete d[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this,r=o["_on"+e];return"function"==typeof t&&r.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),o},off:function(e,t,n){var i=this,o=i["_on"+e],r=0;if(t){for(r=0;r<o.length;r++)if(t===o[r].fn&&n===o[r].id){o.splice(r,1);break}}else if(e)i["_on"+e]=[];else{var s=Object.keys(i);for(r=0;r<s.length;r++)0===s[r].indexOf("_on")&&Array.isArray(i[s[r]])&&(i[s[r]]=[])}return i},once:function(e,t,n){var i=this;return i.on(e,t,n,1),i},_emit:function(e,t,n){for(var i=this,o=i["_on"+e],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,o[r].fn),0),o[r].once&&i.off(e,o[r].fn,o[r].id));return i},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,function(){e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended:function(e){var t=this,n=e._sprite,i=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),s._autoSuspend()),t._webAudio||i||t.stop(e._id),t},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new u(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){var t=this;if("undefined"==typeof e){for(var n=[],i=0;i<t._sounds.length;i++)n.push(t._sounds[i]._id);return n}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=d[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,t},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var u=function(e){this._parent=e,this.init()};u.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=s._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node="undefined"==typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),e._node.gain.setValueAtTime(n,s.ctx.currentTime),e._node.paused=!0,e._node.connect(s.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(s._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=n*s.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(s._canPlayEvent,e._loadFn,!1)}};var d={},l=function(e){var t=e._src;if(d[t])return e._duration=d[t].duration,void p(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);c(i.buffer,e)}else{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){var t=(r.status+"")[0];return"0"!==t&&"2"!==t&&"3"!==t?void e._emit("loaderror",null,"Failed loading audio file with status: "+r.status+"."):void c(r.response,e)},r.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete d[t],e.load())},h(r)}},h=function(e){try{e.send()}catch(t){e.onerror()}},c=function(e,t){s.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(d[t._src]=e,p(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},p=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var i=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());(s._navigator&&s._navigator.standalone&&!i||s._navigator&&!s._navigator.standalone&&!i)&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain="undefined"==typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.value=1,s.masterGain.connect(s.ctx.destination)),s._setup()};i=[],o=function(){return{Howler:s,Howl:a}}.apply(t,i),!(void 0!==o&&(e.exports=o)),t.Howler=s,t.Howl=a,"undefined"!=typeof window?(window.HowlerGlobal=r,window.Howler=s,window.Howl=a,window.Sound=u):"undefined"!=typeof n&&(n.HowlerGlobal=r,n.Howler=s,n.Howl=a,n.Sound=u)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,o,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,o="number"!=typeof o?a[4]:o,r="number"!=typeof r?a[5]:r,"number"!=typeof e?a:(s._orientation=[e,t,n,i,o,r],s.ctx.listener.setOrientation(e,t,n,i,o,r),s)},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:0,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:"inverse",maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:1e4,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:"HRTF",refDistance:"undefined"!=typeof t.refDistance?t.refDistance:1,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var o="undefined"==typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"==typeof n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var r=i._getSoundIds(n),s=0;s<r.length;s++){var a=i._soundById(r[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,o),"spatial"===o?a._panner.setPosition(t,0,0):a._panner.pan.value=t),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(t,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(t,n,i,o)}}),r;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,"undefined"==typeof o){if("number"!=typeof t)return r._pos;r._pos=[t,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var u=r._soundById(s[a]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,i],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),u._panner.setPosition(t,n,i)),r._emit("pos",u._id)}}return r},Howl.prototype.orientation=function(t,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(t,n,i,o)}}),r;if(n="number"!=typeof n?r._orientation[1]:n,i="number"!=typeof i?r._orientation[2]:i,"undefined"==typeof o){if("number"!=typeof t)return r._orientation;r._orientation=[t,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var u=r._soundById(s[a]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,i],u._node&&(u._panner||(u._pos||(u._pos=r._pos||[0,0,-.5]),e(u,"spatial")),u._panner.setOrientation(t,n,i)),r._emit("orientation",u._id)}}return r},Howl.prototype.pannerAttr=function(){var t,n,i,o=this,r=arguments;if(!o._webAudio)return o;if(0===r.length)return o._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return i=o._soundById(parseInt(r[0],10)),i?i._pannerAttr:o._pannerAttr;t=r[0],"undefined"==typeof n&&(o._pannerAttr={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:o._coneOuterAngle,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:o._coneOuterGain,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:o._distanceModel,maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:o._maxDistance,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:o._panningModel,refDistance:"undefined"!=typeof t.refDistance?t.refDistance:o._refDistance,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:o._rolloffFactor})}else 2===r.length&&(t=r[0],n=parseInt(r[1],10));for(var s=o._getSoundIds(n),a=0;a<s.length;a++)if(i=o._soundById(s[a])){var u=i._pannerAttr;u={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:u.coneOuterAngle,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:u.coneOuterGain,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:u.distanceModel,maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:u.maxDistance,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:u.panningModel,refDistance:"undefined"!=typeof t.refDistance?t.refDistance:u.refDistance,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:u.rolloffFactor};var d=i._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.panningModel=u.panningModel,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor):(i._pos||(i._pos=o._pos||[0,0,-.5]),e(i,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t=t||"spatial","spatial"===t?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.value=e._stereo),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id)}}()}).call(t,function(){return this}())},function(e,t,n){"use strict";var i=n(16),o=n(21),r=n(23),s=n(24),a=n(19),u=n(22),d=n(4),l=n(13),h=1e4,c=function(){function e(e){this.level=0,this.extraLifeScore=0,this.score=0,this.lives=3,this.shipBullets=[],this.alienBullets=[],this.explosions=[],this.rocks=[],this.shipTimer=0,this.alienTimer=0,this.levelTimer=0,this.gameOverTimer=0,this.gameOver=!1,this.started=!1,this.paused=!1,this.highscore=e}return Object.defineProperty(e.prototype,"objects",{get:function(){return[this.ship,this.alien].concat(this.shipBullets,this.alienBullets,this.rocks,this.explosions)},enumerable:!0,configurable:!0}),e.prototype.startLevel=function(){this.level++,this.levelTimer=0,this.alienTimer=u.random(10,15),this.addRocks()},e.prototype.addRocks=function(){for(var e=Math.min(this.level+3,7),t=150,n=0;n<e;n++){var i=u.random(1,4),o=new a.Vector(u.random(1,360)),r=void 0,l=void 0;switch(i){case 1:r=u.random(40,d.default.width-40),l=u.random(40,80);break;case 2:r=u.random(d.default.width-80,d.default.width-40),l=u.random(d.default.height-40,d.default.height-40);break;case 3:r=u.random(40,d.default.width-40),l=u.random(d.default.height-40,d.default.height-40);break;default:r=u.random(40,80),l=u.random(d.default.height-40,d.default.height-40)}var h=new s.Rock(r,l,o,s.RockSize.Large,t);this.rocks.push(h)}},e.prototype.addShip=function(e,t){var n=this;this.ship=new i.Ship(e,t),this.ship.on("fire",function(e,t){t.on("expired",function(){n.shipBullets=n.shipBullets.filter(function(e){return e!==t})}),n.shipBullets.push(t)})},e.prototype.createExplosion=function(e,t){var n=this,i=new r.Explosion(e,t);i.on("expired",function(){n.explosions=n.explosions.filter(function(e){return e!==i})}),this.explosions.push(i)},e.prototype.shipDestroyed=function(){l.largeExplosion.play(),this.createExplosion(this.ship.origin.x,this.ship.origin.y),this.lives--,this.ship=null,this.shipBullets=[]},e.prototype.alienDestroyed=function(){l.largeAlien.stop(),l.largeExplosion.play(),this.createExplosion(this.alien.origin.x,this.alien.origin.y),this.alien=null,this.alienBullets=[]},e.prototype.rockDestroyed=function(e){this.createExplosion(e.origin.x,e.origin.y),this.rocks=this.rocks.filter(function(t){return t!==e}),(t=this.rocks).push.apply(t,e.split()),e=null;var t},e.prototype.addAlien=function(){var e=this;this.alien=new o.BigAlien,this.alien.on("expired",function(){l.largeAlien.stop(),e.alien.destroy(),e.alien=null,e.alienBullets.forEach(function(e){return e.destroy()}),e.alienBullets=[]}),this.alien.on("fire",function(t,n){n.on("expired",function(){e.alienBullets=e.alienBullets.filter(function(e){return e!==n})}),e.alienBullets.push(n)}),l.largeAlien.play()},e.prototype.hyperspace=function(){var e=u.random(40,d.default.width-40),t=u.random(40,d.default.height-40),n=this.ship.angle;this.addShip(e,t),this.ship.angle>n?n=-(this.ship.angle-n):this.ship.angle<n&&(n-=this.ship.angle),this.ship.rotate(n)},e.prototype.drawExtraLives=function(){for(var e=Math.min(this.lives,10),t=new i.Ship(0,0),n=0;n<e;n++)t.origin.x=80+20*n,t.origin.y=55,t.render()},e.prototype.addScore=function(e){this.score+=e,this.extraLifeScore+=e,this.score>this.highscore&&(this.highscore=this.score),this.extraLifeScore>=h&&(this.lives++,this.extraLifeScore=0,l.extraLife.play())},e.prototype.tryPlaceShip=function(e){if(this.shipTimer+=e,!(this.shipTimer<=2)){var t={x:d.default.width2-120,y:d.default.height2-120,width:240,height:240},n=!1;this.rocks.forEach(function(e){n=n||e.collided(t)}),this.alien&&(n=n||this.alien.collided(t)),n||(this.shipTimer=0,this.addShip(d.default.width2,d.default.height2))}},e.prototype.updateAlienTimer=function(e){this.alien||(this.alienTimer-=e,this.alienTimer<=0&&(this.addAlien(),this.alienTimer=u.random(10,15)))},e.prototype.shouldTryToPlaceShip=function(){return!!this.shipTimer||!this.ship&&this.lives&&!this.explosions.length},e.prototype.shouldCheckForNextLevel=function(){return!this.rocks.length&&this.lives&&!this.explosions.length&&!this.alien},e.prototype.shouldCheckCollisions=function(){return!!(this.ship||this.shipBullets.length||this.alien||this.alienBullets.length)},e}();t.State=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(4),r=n(7),s=n(17),a=n(19),u=n(20),d=n(13),l=.1,h=800,c=.1,p=.007,f=5,_=1100,y=4,v=100,m=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.points=[{x:5,y:8},{x:0,y:20},{x:-5,y:8}],i}return i(t,e),t.prototype.update=function(){},t.prototype.render=function(){this.draw()},t}(s.Object2D),g=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.moving=!1,i.bulletCount=0,i.bulletTimer=0,i.flame=new m(t,n),i.points=[{x:0,y:-15},{x:10,y:10},{x:5,y:5},{x:-5,y:5},{x:-10,y:10},{x:0,y:-15}],i.angle=270,i}return i(t,e),t.prototype.render=function(){o.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color),this.moving&&(Math.floor(10*Math.random())+1)%2===0&&this.flame.draw()},t.prototype.update=function(e){this.move(e),this.flame.move(e),r.Key.isDown(r.Key.UP)?(this.moving=!0,this.thrust()):this.moving=!1,r.Key.isPressed(r.Key.LEFT)&&this.rotate(-1),r.Key.isDown(r.Key.LEFT)&&this.rotate(-f),r.Key.isPressed(r.Key.RIGHT)&&this.rotate(1),r.Key.isDown(r.Key.RIGHT)&&this.rotate(f),r.Key.isDown(r.Key.CTRL)&&this.fire(),this.bulletTimer>0&&(this.bulletTimer-=e),this.moving||(this.vx-=this.vx*p,this.vy-=this.vy*p,this.flame.vx=this.vx,this.flame.vy=this.vy)},t.prototype.rotate=function(t){e.prototype.rotate.call(this,t),this.flame.rotate(t)},t.prototype.thrust=function(){var e=new a.Vector(this.angle,v*l),t=this.magnitude;t<_&&(this.vx+=e.x,this.flame.vx=this.vx,this.vy+=e.y,this.flame.vy=this.vy),d.thrust.play()},t.prototype.fire=function(){var e=this;if(this.bulletTimer<=0&&this.bulletCount<y){d.fire.play(),this.bulletTimer=c,this.bulletCount++;var t=new a.Vector(this.angle),n=new u.Bullet(this.origin.x,this.origin.y,t);n.life=1,n.on("expired",function(){e.bulletCount--}),n.origin.x+=20*n.vx,n.origin.y+=20*n.vy;var i=0,o=this.vx*n.vx+this.vy*n.vy;o>0&&(i=this.magnitude),i=Math.max(h,i+h),n.vx*=i,n.vy*=i,this.trigger("fire",n)}},t}(s.Object2D);t.Ship=g},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(4),r=n(8),s=n(18),a=function(e){function t(t,n){var i=e.call(this)||this;return i.color="rgba(255,255,255,.9)",i.angle=360,i.vx=0,i.vy=0,i._xmin=0,i._xmax=0,i._ymin=0,i._ymax=0,i._width=0,i._height=0,i.origin={x:t,y:n},i}return i(t,e),Object.defineProperty(t.prototype,"points",{get:function(){return this._points},set:function(e){this._points=e,this.calcBounds()},enumerable:!0,configurable:!0}),t.prototype.calcBounds=function(){var e=this;this._points.forEach(function(t){t.x<e._xmin&&(e._xmin=t.x),t.x>e._xmax&&(e._xmax=t.x),t.y<e._ymin&&(e._ymin=t.y),t.y>e._ymax&&(e._ymax=t.y)}),this._width=this._xmax-this._xmin,this._height=this._ymax-this._ymin},t.prototype.rotate=function(e){this.angle+=e,this.angle<1&&(this.angle+=360),this.angle>360&&(this.angle-=360);var t=s.COS[e],n=s.SIN[e];this.points.forEach(function(e){var i=t*e.x-n*e.y,o=n*e.x+t*e.y;e.x=i,e.y=o}),this.calcBounds()},t.prototype.move=function(e){e=e?e:1,this.origin.x+=this.vx*e,this.origin.y+=this.vy*e,this.origin.x>o.default.width&&(this.origin.x-=o.default.width),this.origin.x<0&&(this.origin.x+=o.default.width),this.origin.y>o.default.height&&(this.origin.y-=o.default.height),this.origin.y<0&&(this.origin.y+=o.default.height)},t.prototype.scale=function(e){this.points.forEach(function(t){t.x*=e,t.y*=e}),this.calcBounds()},t.prototype.draw=function(){o.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color)},Object.defineProperty(t.prototype,"magnitude",{get:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.origin.x+this._xmin},set:function(e){this.origin.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.origin.y+this._ymin},set:function(e){this.origin.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertices",{get:function(){var e=this;return this.points.map(function(t){return{x:e.origin.x+t.x,y:e.origin.y+t.y}})},enumerable:!0,configurable:!0}),t.prototype.collided=function(e){return!!(e&&this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.height+this.y>e.y)},t.prototype.destroy=function(){for(var e in this.handlers)this.handlers[e]=null;this.handlers={}},t}(r.EventSource);t.Object2D=a},function(e,t){"use strict";var n={};t.RAD=n;var i={};t.COS=i;var o={};t.SIN=o;for(var r=Math.PI/180,s=0;s<=360;s++)n[s]=s*r,i[s]=Math.cos(n[s]),o[s]=Math.sin(n[s]),n[-s]=-s*r,i[-s]=Math.cos(n[-s]),o[-s]=Math.sin(n[-s])},function(e,t){"use strict";for(var n={},i=2*Math.PI,o=0;o<=360;o++){var r=i*(o/360);n[o]={x:Math.cos(r),y:Math.sin(r)}}var s=function(){function e(e,t){void 0===t&&(t=1),this.x=n[e].x*t,this.y=n[e].y*t}return e.fromXY=function(t,n,i){void 0===i&&(i=1);var o=t.x-n.x,r=t.y-n.y,s=Math.sqrt(o*o+r*r);o/=s,r/=s;var a=new e(0);return a.x=o*i,a.y=r*i,a},e}();t.Vector=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(4),r=n(17),s=function(e){function t(t,n,i){var o=e.call(this,t,n)||this;return o.life=1.25,o.vx=i.x,o.vy=i.y,o}return i(t,e),t.prototype.render=function(){this.draw()},t.prototype.update=function(e){this.move(e),this.life-=e,this.life<=0&&(this.trigger("expired"),this.destroy())},t.prototype.draw=function(){o.default.draw.point({x:this.origin.x,y:this.origin.y})},t.prototype.destroy=function(){this.life=0,this.trigger("expire")},Object.defineProperty(t.prototype,"vertices",{get:function(){return[this.origin]},enumerable:!0,configurable:!0}),t}(r.Object2D);t.Bullet=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(4),r=n(22),s=n(17),a=n(20),u=n(19),d=n(13),l=600,h=225,c=250,p=function(e){function t(t){var n=e.call(this,0,0)||this;return n.moveTimer=0,n.moveTime=1,n.bulletTimer=0,n.bulletTime=.7,n.vy=0,n.origin.y=r.random(100,o.default.height-100),n.origin.y%2===0?(n.origin.x=40,n.vx=t):(n.origin.x=o.default.width-40,n.vx=-t),n.points=[{x:.5,y:-2},{x:1,y:-1},{x:2.5,y:0},{x:1,y:1},{x:-1,y:1},{x:-2.5,y:0},{x:-1,y:-1},{x:-.5,y:-2},{x:.5,y:-2}],n}return i(t,e),t.prototype.update=function(e){if(this.move(e),this.origin.x>=o.default.width-5||this.origin.x<=5)return void this.trigger("expired");if(this.moveTimer+=e,this.moveTimer>=1&&0!==this.vy&&(this.vy=0,this.moveTimer=0),this.moveTimer>=this.moveTime){var t=r.random(1,20)%2===0;t&&(this.vy=this.origin.x%2===0?this.vx:-this.vx),this.moveTimer=0}this.bulletTimer+=e,this.bulletTimer>=this.bulletTime&&(this.fire(),this.bulletTimer=0)},t.prototype.render=function(){this.draw()},t.prototype.draw=function(){e.prototype.draw.call(this),o.default.draw.shape([this.points[1],this.points[6]],this.origin.x,this.origin.y),o.default.draw.shape([this.points[2],this.points[5]],this.origin.x,this.origin.y)},t}(s.Object2D);t.Alien=p;var f=function(e){function t(){var t=e.call(this,h)||this;return t.score=200,t.scale(7),t}return i(t,e),t.prototype.fire=function(){var e=new u.Vector(r.random(1,360),l),t=new a.Bullet(this.origin.x,this.origin.y,e);this.trigger("fire",t),d.alienFire.stop(),d.alienFire.play()},t.prototype.destroy=function(){},t}(p);t.BigAlien=f;var _=function(e){function t(t){var n=e.call(this,c)||this;return n.ship=t,n.score=1e3,n.bulletTime=1,n.scale(4),n}return i(t,e),t.prototype.fire=function(){var e;if(this.ship){var t=u.Vector.fromXY(this.ship.origin,this.origin,l);e=new a.Bullet(this.origin.x,this.origin.y,t)}else{var t=new u.Vector(r.random(1,360),l);e=new a.Bullet(this.origin.x,this.origin.y,t)}this.trigger("fire",e),d.alienFire.stop(),d.alienFire.play()},t.prototype.destroy=function(){this.ship=null},t}(p);t.SmallAlien=_},function(e,t){"use strict";function n(e,t){return Math.floor(Math.random()*(t-e+1))+e}t.random=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(8),r=n(4),s=n(19),a=n(22),u=150,d=function(e){function t(t,n){var i=e.call(this)||this;i.life=1.25,i.points=[];for(var o=0;o<15;o++){var r=new s.Vector(a.random(1,360),Math.random()*u);i.points.push({x:t,y:n,vx:r.x,vy:r.y})}return i}return i(t,e),t.prototype.update=function(e){this.points.forEach(function(t){t.x+=t.vx*e,t.y+=t.vy*e}),this.life-=e,this.life<=0&&this.trigger("expired")},t.prototype.render=function(e){var t=this;this.points.forEach(function(e){r.default.draw.point(e,"rgba(255,255,255,"+t.life+")")})},t}(o.EventSource);t.Explosion=d},function(e,t,n){"use strict";var i,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(17),s=n(19),a=n(22),u=n(13);!function(e){e[e.Small=5]="Small",e[e.Medium=10]="Medium",e[e.Large=20]="Large"}(i=t.RockSize||(t.RockSize={}));var d=function(e){function t(t,n,i,o,r){void 0===r&&(r=1);var s=e.call(this,t,n)||this;s.rotTimer=0,s.rock1=[[.5,-2],[2,-1],[2,-.7],[1.2,0],[2,1],[1,2],[.5,1.5],[-1,2],[-2,.7],[-2,-1],[-.5,-1],[-1,-2],[.5,-2]],s.rock2=[[0,-1.5],[1,-2],[2,-1],[1,-.5],[2,.5],[1,2],[-.5,1.5],[-1,2],[-2,1],[-1.5,0],[-2,-1],[-1,-2],[0,-1.5]],s.rock3=[[0,-1],[1,-2],[2,-1],[1.5,0],[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[0,-1]],s.rocks=[s.rock1,s.rock2,s.rock3],s.vx=i.x*r,s.vy=i.y*r;var u=a.random(0,2),d=s.rocks[u];return s.points=d.map(function(e){return{x:e[0]*o,y:e[1]*o}}),s.size=o,s.rotate(a.random(1,90)),s.rot=a.random(.01,1)%2===0?1:-1,s.timeToRot=a.random(1,5),s}return o(t,e),t.prototype.update=function(e){this.rotTimer+=1,this.move(e),this.rotTimer===this.timeToRot&&(this.rotate(this.rot),this.rotTimer=0)},t.prototype.render=function(){this.draw()},Object.defineProperty(t.prototype,"direction",{get:function(){var e=Math.atan2(this.vy,this.vx),t=e*(180/Math.PI);return t=t>0?t:360+t,Math.floor(t)},enumerable:!0,configurable:!0}),t.prototype.split=function(){switch(console.log("sound should play"),this.size){case i.Large:u.largeExplosion.play();break;case i.Medium:u.mediumExplosion.play();break;case i.Small:u.smallExplosion.play()}if(this.size>i.Small){var e=a.random(this.direction,this.direction+80),n=a.random(this.direction-80,this.direction);e<0&&(e+=360),e>360&&(e-=360),n<0&&(n+=360),n>360&&(n-=360);var o=this.size===i.Large?i.Medium:i.Small,r=new s.Vector(e),d=new s.Vector(n),l=o===i.Medium?a.random(150,250):a.random(250,350),h=o===i.Medium?a.random(150,250):a.random(250,350),c=new t(this.origin.x,this.origin.y,r,o,l),p=new t(this.origin.x,this.origin.y,d,o,h);
return[c,p]}return[]},Object.defineProperty(t.prototype,"score",{get:function(){return this.size===i.Large?20:this.size===i.Medium?50:100},enumerable:!0,configurable:!0}),t}(r.Object2D);t.Rock=d}]);