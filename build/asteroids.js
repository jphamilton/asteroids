!function(t){function i(s){if(e[s])return e[s].exports;var o=e[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){"use strict";var s=e(1),o=e(2),n=e(3),r=e(6),h=e(9),a=e(19),u=e(7),c=function(){function t(){this.state="start",this.demoTimer=0,this.init()}return t.prototype.init=function(){var t=this;this.highScoreState=new n.HighScoreState,this.demoState=new h.DemoState,this.gameState=new a.GameState,this.gameState.on("done",function(i,e){t.init(),o.highscores.qualifies(e)?(t.initialsState=new r.EnterHighScoreState(e),t.initialsState.on("done",function(){t.state="start"}),t.state="initials"):t.state="start"}),this.demoStarted=!1},t.prototype.update=function(t){switch(this.state){case"start":this.highScoreState.update(t),this.demoStarted&&this.demoState.update(t),u.Key.isPressed(u.Key.ONE)&&(this.state="game"),this.updateDemoTimer(t);break;case"demo":this.demoState.update(t),u.Key.isPressed(u.Key.ONE)&&(this.state="game"),this.updateDemoTimer(t);break;case"initials":this.initialsState.update(t);break;case"game":this.gameState.update(t)}},t.prototype.render=function(t){switch(this.state){case"start":this.highScoreState.render(t);break;case"demo":this.demoState.render(t);break;case"initials":this.initialsState.render(t);break;case"game":this.gameState.render(t)}u.Key.update()},t.prototype.updateDemoTimer=function(t){this.demoTimer+=t,this.demoTimer>=10&&(this.demoTimer=0,this.state="demo"===this.state?"start":"demo")},t}();i.Asteroids=c;var l=new c;setTimeout(function(){s.loop(l)},1e3)},function(t,i){"use strict";var e,s=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},o=0,n=s(),r=1/60,h=1e3,a=function(t){var i=function(){for(e=s(),o+=Math.min(1,(e-n)/h);o>r;)t.update(r),o-=r;t.render(o),n=e,requestAnimationFrame(i)};i()};i.loop=function(t){a(t)}},function(t,i){"use strict";var e=[{score:20140,initials:"J H"},{score:20050,initials:"P A"},{score:19930,initials:"  M"},{score:19870,initials:"G I"},{score:19840,initials:"A L"},{score:19790,initials:"M T"},{score:19700,initials:"E O"},{score:19660,initials:"S N"},{score:190,initials:"   "},{score:70,initials:"   "}],s="jph_asteroids_hs",o=function(){function t(){this.scores=[];var t=window.localStorage.getItem(s);this.scores=t?JSON.parse(t)||[]:e}return Object.defineProperty(t.prototype,"top",{get:function(){return this.scores[0]},enumerable:!0,configurable:!0}),t.prototype.qualifies=function(t){var e=i.highscores.scores.filter(function(i){return i.score<t});return!!e.length},t.prototype.save=function(t,i){this.qualifies(t)&&(this.scores.push({score:t,initials:i}),this.scores=this.scores.sort(function(t,i){return t.score>i.score?-1:1}).slice(0,10),window.localStorage.setItem(s,JSON.stringify(this.scores)))},t}();i.highscores=new o},function(t,i,e){"use strict";var s=e(4),o=e(2),n=function(){function t(){this.blink=0,this.showPushStart=!0,this.highscore=o.highscores.top.score}return t.prototype.update=function(t){this.blink+=t,this.blink>=.4&&(this.blink=0,this.showPushStart=!this.showPushStart)},t.prototype.render=function(){this.drawBackground(),this.drawPushStart(),this.drawHighScores()},t.prototype.drawBackground=function(){s.default.draw.background(),s.default.draw.scorePlayer1(0),s.default.draw.highscore(this.highscore),s.default.draw.copyright()},t.prototype.drawHighScores=function(){var t=s.default.width/2;s.default.draw.text2("high scores","30pt",function(i){return{x:t-i/2,y:200}});for(var i=function(i){var n=280+40*i,r=e.pad(i+1," ",2)+"."+e.pad(o.highscores.scores[i].score," ",6)+" "+o.highscores.scores[i].initials;s.default.draw.text2(r,"30pt",function(i){return{x:t-i/2,y:n}})},e=this,n=0;n<o.highscores.scores.length;n++)i(n)},t.prototype.drawPushStart=function(){var t=s.default.width/2;this.showPushStart&&s.default.draw.text2("push start","30pt",function(i){return{x:t-i/2,y:120}})},t.prototype.pad=function(t,i,e){for(t=t.toString();t.length<e;)t=i+t;return t},t}();i.HighScoreState=n},function(t,i,e){"use strict";var s=e(5),o=function(){function t(){var t=this;this.x=0,this.y=0,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.draw=new s.Draw(this.ctx),this.init(),window.addEventListener("resize",function(){t.init()})}return t.prototype.init=function(){this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.width=this.canvas.width,this.height=this.canvas.height,this.width2=this.width/2,this.height2=this.height/2},t}();i.Screen=o,Object.defineProperty(i,"__esModule",{value:!0}),i.default=new o},function(t,i,e){"use strict";var s=e(4),o="rgba(255,255,255,1)",n=function(){function t(t){this.ctx=t}return t.prototype.line=function(t,i,e,s){void 0===e&&(e=o),void 0===s&&(s=2);var n=this.ctx;n.beginPath(),n.strokeStyle=e,n.lineWidth=s,n.moveTo(t.x,t.y),n.lineTo(i.x,i.y),n.stroke(),n.closePath()},t.prototype.shape=function(t,i,e,s){void 0===s&&(s=o);for(var n,r,h=0;h<t.length-1;h++)n={x:i+t[h].x,y:e+t[h].y},r={x:i+t[h+1].x,y:e+t[h+1].y},this.line(n,r,s,2)},t.prototype.rect=function(t,i,e){void 0===e&&(e=o);var s=this.ctx;s.beginPath(),s.fillStyle=e,s.fillRect(t.x,t.y,i.x,i.y),s.stroke(),s.closePath()},t.prototype.point=function(t,i){void 0===i&&(i=o),this.rect(t,{x:4,y:4},i)},t.prototype.background=function(){this.rect({x:0,y:0},{x:s.default.width,y:s.default.height},"#000000")},t.prototype.bounds=function(t,i){void 0===i&&(i=o);var e=this.ctx;t&&(e.save(),e.beginPath(),e.strokeStyle=i,e.lineWidth=2,e.moveTo(t.x,t.y),e.lineTo(t.x+t.width,t.y),e.lineTo(t.x+t.width,t.y+t.height),e.lineTo(t.x,t.y+t.height),e.lineTo(t.x,t.y),e.stroke(),e.closePath(),e.restore())},t.prototype.text=function(t,i,e,s){var n=this.ctx;n.save(),n.font=s+" hyperspace",n.textBaseline="middle",n.lineWidth=1,n.strokeStyle=o,n.strokeText(t,i,e),n.restore()},t.prototype.text2=function(t,i,e){var s=this.ctx;s.save(),s.font=i+" hyperspace",s.textBaseline="middle",s.lineWidth=1,s.strokeStyle=o;var n=s.measureText(t).width,r=e(n);s.strokeText(t,r.x,r.y),s.restore()},t.prototype.text3=function(t,i,e){var s=this.ctx;s.save(),s.font=i+" hyperspace",s.textBaseline="middle",s.lineWidth=2,s.fillStyle=o;var n=s.measureText(t).width,r=e(n);s.fillText(t,r.x,r.y),s.restore()},t.prototype.scorePlayer1=function(t){for(var i=t.toString();i.length<2;)i="0"+i;this.text(i,100,20,"24pt")},t.prototype.highscore=function(t){for(var i=t.toString();i.length<2;)i="0"+i;this.text2(i,"12pt",function(t){return{x:s.default.width/2-t/2,y:20}})},t.prototype.copyright=function(){this.text2(String.fromCharCode(169)+" 1979 Atari INC","12pt",function(t){return{x:s.default.width/2-t/2,y:s.default.height-20}})},t.prototype.quadtree=function(t){if(t){var i=function(t){t&&t.forEach(function(t){s.default.draw.bounds(t.bounds),i(t.nodes)})};i(t.nodes)}},t}();i.Draw=n},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(4),n=e(7),r=e(2),h=e(8),a="_abcdefghijklmnopqrstuvwxyz",u=function(t){function i(i){var e=t.call(this)||this;return e.index=1,e.score=i,e.init(),e}return s(i,t),i.prototype.init=function(){this.position=0,this.index=1,this.initials=["a","_","_"]},i.prototype.update=function(t){n.Key.isPressed(n.Key.LEFT)&&(this.index--,this.index<0&&(this.index=a.length-1),this.initials[this.position]=a[this.index]),n.Key.isPressed(n.Key.RIGHT)&&(this.index++,this.index>a.length-1&&(this.index=0),this.initials[this.position]=a[this.index]),n.Key.isPressed(n.Key.SPACE)&&(this.position++,this.position>=3&&(console.log(this.score,this.initials.join("")),r.highscores.save(this.score,this.initials.join("")),this.init(),this.trigger("done")),this.index=1,this.initials[this.position]=a[this.index])},i.prototype.render=function(){var t=165,i=function(i){return o.default.draw.text(i,50,t+=35,"30pt")};o.default.draw.background(),o.default.draw.highscore(r.highscores.top.score),o.default.draw.scorePlayer1(this.score),o.default.draw.copyright(),i("your score is one of the ten best"),i("please enter your initials"),i("push rotate to select letter"),i("push hyperspace when letter is correct"),o.default.draw.text3(this.initials.join(""),"60pt",function(t){return{x:o.default.width/2-t,y:o.default.height/2}})},i}(h.EventSource);i.EnterHighScoreState=u},function(t,i){"use strict";var e=222,s=function(){function t(){var t=this;this.SPACE=32,this.LEFT=37,this.UP=38,this.RIGHT=39,this.SHIFT=16,this.CTRL=17,this.ONE=49,this.DEBUG=68,this.PAUSE=80,this.keys=new Array(e),this.prev=new Array(e);for(var i=0;i<e;i++)this.keys[i]=this.prev[i]=!1;window.onkeydown=function(i){t.keys[i.keyCode]=!0},window.onkeyup=function(i){t.keys[i.keyCode]=!1}}return t.prototype.update=function(){for(var t=0;t<e;t++)this.prev[t]=this.keys[t]},t.prototype.isPressed=function(t){return this.prev[t]===!1&&this.keys[t]===!0},t.prototype.wasPressed=function(t){return this.prev[t]&&!this.keys[t]},t.prototype.isDown=function(t){return this.keys[t]},t}();i._Key=s,i.Key=new s},function(t,i){"use strict";var e=function(){function t(){this.handlers={}}return t.prototype.on=function(t,i){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(i)},t.prototype.off=function(t,i){this.handlers[t]=this.handlers[t].filter(function(t){return t!==i})},t.prototype.trigger=function(t){for(var i=this,e=[],s=1;s<arguments.length;s++)e[s-1]=arguments[s];var o=this.handlers[t]||[];o.forEach(function(t){return t.apply(void 0,[i].concat(e))})},t}();i.EventSource=e},function(t,i,e){"use strict";var s=e(4),o=e(10),n=e(2),r=e(7),h=e(11),a=e(15),u=e(17),c=e(18),l=e(14),d=function(){function t(){this.blinkTimer=0,this.modeTimer=0,this.alienTimer=0,this.showPushStart=!0,this.rocks=[],this.explosions=[],this.alienBullets=[],this.debug=!1,this.paused=!1,this.level=1,this.highscore=n.highscores.scores.length?n.highscores.top.score:0,this.addRocks()}return t.prototype.update=function(t){r.Key.isPressed(r.Key.DEBUG)&&(this.debug=!this.debug),r.Key.isPressed(r.Key.PAUSE)&&(this.paused=!this.paused),this.paused||(this.alien||this.rocks.length||(this.level++,this.addRocks()),this.updateAlienTimer(t),this.pushStart(t),this.checkCollisions(),this.updateAllObjects(t))},t.prototype.updateAlienTimer=function(t){this.alien||(this.alienTimer+=t),this.alienTimer>=7&&this.createBigAlien()},t.prototype.pushStart=function(t){this.blinkTimer+=t,this.blinkTimer>=.4&&(this.blinkTimer=0,this.showPushStart=!this.showPushStart)},t.prototype.checkCollisions=function(){var t=this;this.alien&&(this.bounds=[],this.qt=new c.Quadtree({x:0,y:0,width:s.default.width,height:s.default.height},1),this.rocks.forEach(function(i){t.alien&&t.qt.insert(i)})),this.checkAlienCollision(),this.checkAlienBulletCollision()},t.prototype.checkAlienCollision=function(){var t=this;if(this.alien){var i=this.qt.retrieve(this.alien);i.forEach(function(i){i.collided(t.alien)&&(t.createExplosion(t.alien.origin.x,t.alien.origin.y),t.createExplosion(i.origin.x,i.origin.y),t.splitRock(i),t.alien=null,t.alienBullets=[]),t.debug&&t.bounds.push(i)})}},t.prototype.checkAlienBulletCollision=function(){var t=this;this.alienBullets.forEach(function(i){var e=[];t.alien&&(e.push.apply(e,t.qt.retrieve(i)),e.forEach(function(e){e.collided(i)&&(t.createExplosion(e.origin.x,e.origin.y),t.alienBullets=t.alienBullets.filter(function(t){return t!==i}),t.splitRock(e),i=null),t.debug&&t.bounds.push(e)})),t.debug&&(s=t.bounds).push.apply(s,e.concat([t.alien]));var s})},t.prototype.updateAllObjects=function(t){var i=[this.alien].concat(this.rocks,this.alienBullets,this.explosions);i.forEach(function(i){i&&i.update(t)})},t.prototype.render=function(){this.drawBackground(),this.drawPushStart();var t=this.rocks.concat([this.alien],this.alienBullets,this.explosions);t.forEach(function(t){t&&t.render()}),this.alien&&this.debug&&(this.qt&&s.default.draw.quadtree(this.qt),this.bounds.forEach(function(t){s.default.draw.bounds(t,"#fc058d")})),this.bounds=[],this.debug&&s.default.draw.text2("debug mode","12pt",function(t){return{x:s.default.width-t-10,y:s.default.height-40}})},t.prototype.addRocks=function(){for(var t=Math.min(this.level+3,7),i=200,e=0;e<t;e++){var n=new l.Vector(o.random(1,360)),r=o.random(40,s.default.width-40),a=o.random(40,s.default.height-40),u=new h.Rock(r,a,n,h.RockSize.Large,i);this.rocks.push(u)}},t.prototype.createBigAlien=function(){var t=this;this.alien=new a.BigAlien,this.alien.on("expired",function(){t.alien.destroy(),t.alien=null,t.alienBullets.forEach(function(t){return t.destroy()}),t.alienBullets=[]}),this.alien.on("fire",function(i,e){e.on("expired",function(){t.alienBullets=t.alienBullets.filter(function(t){return t!==e})}),t.alienBullets.push(e)}),this.alienTimer=0},t.prototype.createExplosion=function(t,i){var e=this,s=new u.Explosion(t,i);s.on("expired",function(){e.explosions=e.explosions.filter(function(t){return t!==s})}),this.explosions.push(s)},t.prototype.splitRock=function(t){this.rocks=this.rocks.filter(function(i){return i!==t}),(i=this.rocks).push.apply(i,t.split()),t=null;var i},t.prototype.drawBackground=function(){s.default.draw.background(),s.default.draw.scorePlayer1(0),s.default.draw.highscore(this.highscore),s.default.draw.copyright()},t.prototype.drawPushStart=function(){var t=s.default.width/2;this.showPushStart&&s.default.draw.text2("push start","30pt",function(i){return{x:t-i/2,y:120}})},t}();i.DemoState=d},function(t,i){"use strict";function e(t,i){return Math.floor(Math.random()*(i-t+1))+t}i.random=e},function(t,i,e){"use strict";var s,o=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},n=e(12),r=e(14),h=e(10);!function(t){t[t.Small=5]="Small",t[t.Medium=10]="Medium",t[t.Large=20]="Large"}(s=i.RockSize||(i.RockSize={}));var a=function(t){function i(i,e,s,o,n){void 0===n&&(n=1);var r=t.call(this,i,e)||this;r.rotTimer=0,r.rock1=[[.5,-2],[2,-1],[2,-.7],[1.2,0],[2,1],[1,2],[.5,1.5],[-1,2],[-2,.7],[-2,-1],[-.5,-1],[-1,-2],[.5,-2]],r.rock2=[[0,-1.5],[1,-2],[2,-1],[1,-.5],[2,.5],[1,2],[-.5,1.5],[-1,2],[-2,1],[-1.5,0],[-2,-1],[-1,-2],[0,-1.5]],r.rock3=[[0,-1],[1,-2],[2,-1],[1.5,0],[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[0,-1]],r.rocks=[r.rock1,r.rock2,r.rock3],r.vx=s.x*n,r.vy=s.y*n;var a=h.random(0,2),u=r.rocks[a];return r.points=u.map(function(t){return{x:t[0]*o,y:t[1]*o}}),r.size=o,r.rotate(h.random(1,90)),r.rot=h.random(1,10)%2===0?1:-1,r.timeToRot=h.random(1,5),r}return o(i,t),i.prototype.update=function(t){this.rotTimer+=1,this.move(t),this.rotTimer===this.timeToRot&&(this.rotate(this.rot),this.rotTimer=0)},i.prototype.render=function(){this.draw()},Object.defineProperty(i.prototype,"direction",{get:function(){var t=Math.atan2(this.vy,this.vx),i=t*(180/Math.PI);return i=i>0?i:360+i,Math.floor(i)},enumerable:!0,configurable:!0}),i.prototype.split=function(){if(this.size>s.Small){var t=h.random(this.direction,this.direction+80),e=h.random(this.direction-80,this.direction);t<0&&(t+=360),t>360&&(t-=360),e<0&&(e+=360),e>360&&(e-=360);var o=this.size===s.Large?s.Medium:s.Small,n=new r.Vector(t),a=new r.Vector(e),u=o===s.Medium?h.random(150,250):h.random(250,350),c=o===s.Medium?h.random(150,250):h.random(250,350),l=new i(this.origin.x,this.origin.y,n,o,u),d=new i(this.origin.x,this.origin.y,a,o,c);return[l,d]}return[]},i}(n.Object2D);i.Rock=a},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(4),n=e(8),r=e(13),h=function(t){function i(i,e){var s=t.call(this)||this;return s.color="rgba(255,255,255,.9)",s.angle=360,s.vx=0,s.vy=0,s._xmin=0,s._xmax=0,s._ymin=0,s._ymax=0,s._width=0,s._height=0,s.origin={x:i,y:e},s}return s(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t,this.calcBounds()},enumerable:!0,configurable:!0}),i.prototype.calcBounds=function(){var t=this;this._points.forEach(function(i){i.x<t._xmin&&(t._xmin=i.x),i.x>t._xmax&&(t._xmax=i.x),i.y<t._ymin&&(t._ymin=i.y),i.y>t._ymax&&(t._ymax=i.y)}),this._width=this._xmax-this._xmin,this._height=this._ymax-this._ymin},i.prototype.rotate=function(t){this.angle+=t,this.angle<1&&(this.angle+=360),this.angle>360&&(this.angle-=360);var i=r.COS[t],e=r.SIN[t];this.points.forEach(function(t){var s=i*t.x-e*t.y,o=e*t.x+i*t.y;t.x=s,t.y=o}),this.calcBounds()},i.prototype.move=function(t){t=t?t:1,this.origin.x+=this.vx*t,this.origin.y+=this.vy*t,this.origin.x>o.default.width&&(this.origin.x-=o.default.width),this.origin.x<0&&(this.origin.x+=o.default.width),this.origin.y>o.default.height&&(this.origin.y-=o.default.height),this.origin.y<0&&(this.origin.y+=o.default.height)},i.prototype.scale=function(t){this.points.forEach(function(i){i.x*=t,i.y*=t}),this.calcBounds()},i.prototype.draw=function(){o.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color)},Object.defineProperty(i.prototype,"magnitude",{get:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this.origin.x+this._xmin},set:function(t){this.origin.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.origin.y+this._ymin},set:function(t){this.origin.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),i.prototype.collided=function(t){return!!(t&&this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.height+this.y>t.y)},i.prototype.destroy=function(){for(var t in this.handlers)this.handlers[t]=null;this.handlers={}},i}(n.EventSource);i.Object2D=h},function(t,i){"use strict";var e={};i.RAD=e;var s={};i.COS=s;var o={};i.SIN=o;for(var n=Math.PI/180,r=0;r<=360;r++)e[r]=r*n,s[r]=Math.cos(e[r]),o[r]=Math.sin(e[r]),e[-r]=-r*n,s[-r]=Math.cos(e[-r]),o[-r]=Math.sin(e[-r])},function(t,i){"use strict";for(var e={},s=2*Math.PI,o=0;o<=360;o++){var n=s*(o/360);e[o]={x:Math.cos(n),y:Math.sin(n)}}var r=function(){function t(t,i){void 0===i&&(i=1),this.x=e[t].x*i,this.y=e[t].y*i}return t}();i.Vector=r},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(4),n=e(10),r=e(12),h=e(16),a=e(14),u=600,c=225,l=function(t){function i(){var i=t.call(this,0,0)||this;return i.moveTimer=0,i.bulletTimer=.7,i.moveTime=2,i.vy=0,i.origin.y=n.random(100,o.default.height-100),i.origin.y%2===0?(i.origin.x=40,i.vx=c):(i.origin.x=o.default.width-40,i.vx=-c),i.points=[{x:.5,y:-2},{x:1,y:-1},{x:2.5,y:0},{x:1,y:1},{x:-1,y:1},{x:-2.5,y:0},{x:-1,y:-1},{x:-.5,y:-2},{x:.5,y:-2}],i.scale(7),i}return s(i,t),i.prototype.update=function(t){if(this.move(t),this.origin.x>=o.default.width-5||this.origin.x<=5)return void this.trigger("expired");if(this.moveTimer+=t,this.moveTimer>=1&&0!==this.vy&&(this.vy=0,this.moveTimer=0),this.moveTimer>=this.moveTime){var i=n.random(1,20)%2===0;i&&(this.vy=this.origin.x%2===0?this.vx:-this.vx),this.moveTimer=0,this.moveTime++}if(this.bulletTimer+=t,this.bulletTimer>=.7){var e=new a.Vector(n.random(1,360),u),s=new h.Bullet(this.origin.x,this.origin.y,e);this.trigger("fire",s),this.bulletTimer=0}},i.prototype.render=function(){this.draw()},i.prototype.draw=function(){t.prototype.draw.call(this),o.default.draw.shape([this.points[1],this.points[6]],this.origin.x,this.origin.y),o.default.draw.shape([this.points[2],this.points[5]],this.origin.x,this.origin.y)},i}(r.Object2D);i.BigAlien=l},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(4),n=e(12),r=function(t){function i(i,e,s){var o=t.call(this,i,e)||this;return o.life=1.25,o.vx=s.x,o.vy=s.y,o}return s(i,t),i.prototype.render=function(){this.draw()},i.prototype.update=function(t){this.move(t),this.life-=t,this.life<=0&&(this.trigger("expired"),this.destroy())},i.prototype.draw=function(){o.default.draw.point({x:this.origin.x,y:this.origin.y})},i.prototype.expire=function(){this.life=0,this.trigger("expire")},i}(n.Object2D);i.Bullet=r},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(8),n=e(4),r=e(14),h=e(10),a=150,u=function(t){function i(i,e){var s=t.call(this)||this;s.life=1.25,s.points=[];for(var o=0;o<15;o++){var n=new r.Vector(h.random(1,360),Math.random()*a);s.points.push({x:i,y:e,vx:n.x,vy:n.y})}return s}return s(i,t),i.prototype.update=function(t){this.points.forEach(function(i){i.x+=i.vx*t,i.y+=i.vy*t}),this.life-=t,this.life<=0&&this.trigger("expired")},i.prototype.render=function(t){var i=this;this.points.forEach(function(t){n.default.draw.point(t,"rgba(255,255,255,"+i.life+")")})},i}(o.EventSource);i.Explosion=u},function(t,i){"use strict";var e=function(){function t(t,i,e,s){void 0===i&&(i=10),void 0===e&&(e=4),void 0===s&&(s=0),this.bounds=t,this.maxObjects=i,this.maxLevels=e,this.level=s,this.objects=[],this.nodes=[],this.width2=this.bounds.width/2,this.height2=this.bounds.height/2,this.xmid=this.bounds.x+this.width2,this.ymid=this.bounds.y+this.height2}return t.prototype.insert=function(t){var i=this;if(t){var e,s=0;if(this.nodes.length&&(e=this.getIndex(t),e.length))return void e.forEach(function(e){i.nodes[e].insert(t)});if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels){this.nodes.length||this.split();for(var o=function(){if(e=n.getIndex(n.objects[s]),e.length){var t=n.objects.splice(s,1)[0];e.forEach(function(e){i.nodes[e].insert(t)})}else s+=1},n=this;s<this.objects.length;)o()}}},t.prototype.retrieve=function(t){var i=this,e=this.getIndex(t),s=this.objects;if(this.nodes.length)if(e.length)e.forEach(function(e){s=s.concat(i.nodes[e].retrieve(t))});else for(var o=0;o<this.nodes.length;o++)s=s.concat(this.nodes[o].retrieve(t));return s.filter(function(t,i,e){return e.indexOf(t)===i})},t.prototype.clear=function(){this.objects=[];for(var t=0;t<this.nodes.length;t++)this.nodes[t]&&this.nodes[t].clear();this.nodes=[]},t.prototype.getIndex=function(t){if(!t)return[];var i=[],e=this,s=e.xmid,o=e.ymid,n=t.y<=o,r=t.y>o;if(t.x<=s)if(n){i.push(1);var h=!1;t.x+t.width>s&&(i.push(0),h=!0),t.y+t.height>o&&(i.push(2),h&&i.push(3))}else r&&(i.push(2),t.x+t.width>s&&i.push(3));else t.x>s&&(n?(i.push(0),t.y+t.height>o&&i.push(3)):i.push(3));return i},t.prototype.split=function(){var i=this,e=Math.round(this.width2),s=Math.round(this.height2),o=Math.round(this.bounds.x),n=Math.round(this.bounds.y),r=function(o,n){var r={x:o,y:n,width:e,height:s};return new t(r,i.maxObjects,i.maxLevels,i.level+1)};this.nodes=[r(o+e,n),r(o,n),r(o,n+s),r(o+e,n+s)]},t}();i.Quadtree=e},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(7),n=e(8),r=e(20),h=e(11),a=e(17),u=e(14),c=e(18),l=e(4),d=e(2),p=e(10),f=function(t){function i(){var i=t.call(this)||this;return i.level=1,i.score=0,i.lives=3,i.shipBullets=[],i.explosions=[],i.extraLifeScore=0,i.debug=!1,i.paused=!1,i.rocks=[],i.bounds=[],i.shipTimer=0,i.highscore=d.highscores.top.score,i.init(),i}return s(i,t),i.prototype.init=function(){this.addShip(l.default.width2,l.default.height2),this.addRocks()},i.prototype.addShip=function(t,i){var e=this;this.ship=new r.Ship(t,i),this.ship.on("fire",function(t,i){i.on("expired",function(){e.shipBullets=e.shipBullets.filter(function(t){return t!==i})}),e.shipBullets.push(i)})},i.prototype.update=function(t){if(o.Key.isPressed(o.Key.DEBUG)&&(this.debug=!this.debug),o.Key.isPressed(o.Key.PAUSE)&&(this.paused=!this.paused),o.Key.isPressed(o.Key.SPACE)&&this.hyperspace(),!this.paused){if((this.shipTimer||!this.ship&&this.lives&&!this.explosions.length)&&this.tryPlaceShip(t),this.rocks.length||!this.lives||this.explosions.length||(this.level++,this.addRocks()),!this.lives&&!this.explosions.length)return void this.trigger("done",this.score);this.checkCollisions();var i=[this.ship].concat(this.shipBullets,this.rocks,this.explosions);i.forEach(function(i){i&&i.update(t)})}},i.prototype.render=function(t){this.renderBackground();var i=[this.ship].concat(this.shipBullets,this.rocks,this.explosions);i.forEach(function(t){t&&t.render()}),this.ship&&this.debug&&l.default.draw.text(this.ship.angle.toString(),this.ship.origin.x+20,this.ship.origin.y+20,"10pt")},i.prototype.renderBackground=function(){if(l.default.draw.background(),l.default.draw.copyright(),l.default.draw.scorePlayer1(this.score),l.default.draw.highscore(this.highscore),this.drawExtraLives(),this.debug&&(l.default.draw.text2("debug mode","12pt",function(t){return{x:l.default.width-t-10,y:l.default.height-40}}),this.debug&&this.bounds&&(l.default.draw.quadtree(this.qt),this.bounds.forEach(function(t){l.default.draw.bounds(t,"#fc058d")})),!this.ship&&this.lives)){var t={x:l.default.width2-120,y:l.default.height2-120,width:240,height:240};l.default.draw.bounds(t,"#00ff00")}},i.prototype.drawExtraLives=function(){for(var t=Math.min(this.lives,10),i=0;i<t;i++){var e=new r.Ship(80+20*i,55);e.render()}},i.prototype.addRocks=function(){for(var t=Math.min(this.level+3,7),i=150,e=0;e<t;e++){var s=p.random(1,4),o=new u.Vector(p.random(1,360)),n=void 0,r=void 0;switch(s){case 1:n=p.random(40,l.default.width-40),r=p.random(40,80);break;case 2:n=p.random(l.default.width-80,l.default.width-40),r=p.random(l.default.height-40,l.default.height-40);break;case 3:n=p.random(40,l.default.width-40),r=p.random(l.default.height-40,l.default.height-40);break;default:n=p.random(40,80),r=p.random(l.default.height-40,l.default.height-40)}var a=new h.Rock(n,r,o,h.RockSize.Large,i);this.rocks.push(a)}},i.prototype.shipDestroyed=function(){this.lives--,this.ship=null,this.shipBullets=[]},i.prototype.checkCollisions=function(){var t=this,i=!!this.ship||!this.shipBullets;if(i){this.bounds=[],this.qt=new c.Quadtree({x:0,y:0,width:l.default.width,height:l.default.height},1),this.rocks.forEach(function(i){t.qt.insert(i)});var e=this.qt.retrieve(this.ship);e.forEach(function(i){i.collided(t.ship)&&(t.createExplosion(t.ship.origin.x,t.ship.origin.y),t.createExplosion(i.origin.x,i.origin.y),t.scoreRock(i),t.splitRock(i),t.shipDestroyed()),t.debug&&t.bounds.push(i)}),this.shipBullets.forEach(function(i){var e=[];e.push.apply(e,t.qt.retrieve(i)),e.forEach(function(e){e.collided(i)&&(t.createExplosion(e.origin.x,e.origin.y),t.scoreRock(e),i.expire(),t.splitRock(e)),t.debug&&t.bounds.push(e)}),t.debug&&(s=t.bounds).push.apply(s,e.concat([t.ship]));var s})}},i.prototype.scoreRock=function(t){var i=t.size===h.RockSize.Large?20:t.size===h.RockSize.Medium?50:100;this.score+=i,this.extraLifeScore+=i,this.score>this.highscore&&(this.highscore=this.score),this.extraLifeScore>=1e4&&this.lives++},i.prototype.splitRock=function(t){this.rocks=this.rocks.filter(function(i){return i!==t}),(i=this.rocks).push.apply(i,t.split()),t=null;var i},i.prototype.createExplosion=function(t,i){var e=this,s=new a.Explosion(t,i);s.on("expired",function(){e.explosions=e.explosions.filter(function(t){return t!==s})}),this.explosions.push(s)},i.prototype.tryPlaceShip=function(t){if(this.shipTimer+=t,!(this.shipTimer<=2)){var i={x:l.default.width2-120,y:l.default.height2-120,width:240,height:240},e=!1;this.rocks.forEach(function(t){e=e||t.collided(i)}),e||(this.shipTimer=0,this.addShip(l.default.width2,l.default.height2))}},i.prototype.hyperspace=function(){var t=p.random(40,l.default.width-40),i=p.random(40,l.default.height-40),e=this.ship.angle;this.addShip(t,i),this.ship.angle>e?this.ship.rotate(this.ship.angle-e):this.ship.angle<e&&this.ship.rotate(this.ship.angle-e),this.ship.rotate(e)},i}(n.EventSource);i.GameState=f},function(t,i,e){"use strict";var s=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},o=e(4),n=e(7),r=e(12),h=e(14),a=e(16),u=.1,c=800,l=.007,d=5,p=1100,f=4,y=100,g=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.points=[{x:5,y:8},{x:0,y:20},{x:-5,y:8}],s}return s(i,t),i.prototype.update=function(){},i.prototype.render=function(){this.draw()},i}(r.Object2D),v=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.moving=!1,s.bulletCount=0,s.bulletTimer=0,s.flame=new g(i,e),s.points=[{x:0,y:-15},{x:10,y:10},{x:5,y:5},{x:-5,y:5},{x:-10,y:10},{x:0,y:-15}],s.angle=270,s}return s(i,t),i.prototype.render=function(){o.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color),this.moving&&(Math.floor(10*Math.random())+1)%2===0&&this.flame.draw()},i.prototype.update=function(t){this.move(t),this.flame.move(t),n.Key.isDown(n.Key.UP)?(this.moving=!0,this.thrust()):this.moving=!1,n.Key.isDown(n.Key.LEFT)&&this.rotate(-d),n.Key.isDown(n.Key.RIGHT)&&this.rotate(d),n.Key.isDown(n.Key.CTRL)&&this.fire(),this.bulletTimer>0&&(this.bulletTimer-=t),this.moving||(this.vx-=this.vx*l,this.vy-=this.vy*l,this.flame.vx=this.vx,this.flame.vy=this.vy)},i.prototype.rotate=function(i){t.prototype.rotate.call(this,i),this.flame.rotate(i)},i.prototype.thrust=function(){var t=new h.Vector(this.angle,y*u),i=this.magnitude;i<=p&&(this.vx+=t.x,this.flame.vx=this.vx,this.vy+=t.y,this.flame.vy=this.vy)},i.prototype.fire=function(){var t=this;if(this.bulletTimer<=0&&this.bulletCount<f){this.bulletTimer=.2,this.bulletCount++;var i=new h.Vector(this.angle),e=new a.Bullet(this.origin.x,this.origin.y,i);e.on("expired",function(){t.bulletCount--}),e.origin.x+=20*e.vx,e.origin.y+=20*e.vy;var s=0,o=this.vx*e.vx+this.vy*e.vy;o>0&&(s=this.magnitude),s=Math.max(c,s+c),e.vx*=s,e.vy*=s,this.trigger("fire",e)}},i}(r.Object2D);i.Ship=v}]);