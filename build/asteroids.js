!function(t){function e(s){if(i[s])return i[s].exports;var r=i[s]={exports:{},id:s,loaded:!1};return t[s].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var s,r=i(1),o=i(2),n=i(3),h=i(6),a=i(9),u=i(12),c=i(7),l=i(13),d=15;!function(t){t[t.Attract=0]="Attract",t[t.Game=1]="Game",t[t.Initials=2]="Initials",t[t.Start=3]="Start"}(s||(s={}));var p=function(){function t(){this.lastScore=0,this.init()}return t.prototype.init=function(t){var e=this;this.mode=s.Start,this.highScoreMode=new n.HighScoreMode(this.lastScore),this.attractMode=new a.AttractMode(t||new l.State(o.highscores.top.score)),this.gameMode=new u.GameMode(new l.State(o.highscores.top.score)),this.attractTimer=0,this.gameMode.on("done",function(t,i){e.lastScore=i.score,o.highscores.qualifies(i.score)?(e.initialsMode=new h.InitialsMode(i.score),e.initialsMode.on("done",function(){e.init(i)}),e.mode=s.Initials):e.init(i)}),this.attractStarted=!1},t.prototype.update=function(t){switch(this.mode){case s.Start:this.highScoreMode.update(t),this.attractStarted&&this.attractMode.update(t),c.Key.isPressed(c.Key.ONE)&&(this.mode=s.Game),this.updateAttractTimer(t);break;case s.Attract:this.attractMode.update(t),c.Key.isPressed(c.Key.ONE)&&(this.mode=s.Game),this.updateAttractTimer(t);break;case s.Initials:this.initialsMode.update(t);break;case s.Game:this.gameMode.update(t)}},t.prototype.render=function(t){switch(this.mode){case s.Start:this.highScoreMode.render(t);break;case s.Attract:this.attractMode.render(t);break;case s.Initials:this.initialsMode.render(t);break;case s.Game:this.gameMode.render(t)}c.Key.update()},t.prototype.updateAttractTimer=function(t){this.attractTimer+=t,this.attractTimer>=d&&(this.attractTimer=0,this.mode=this.mode===s.Attract?s.Start:s.Attract)},t}();e.Asteroids=p;var f=new p;setTimeout(function(){r.loop(f)},1e3)},function(t,e){"use strict";var i,s=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},r=0,o=s(),n=1/60,h=1e3,a=function(t){var e=function(){for(i=s(),r+=Math.min(1,(i-o)/h);r>n;)t.update(n),r-=n;t.render(r),o=i,requestAnimationFrame(e)};e()};e.loop=function(t){a(t)}},function(t,e){"use strict";var i=[{score:20140,initials:"J H"},{score:20050,initials:"P A"},{score:19930,initials:"  M"},{score:19870,initials:"G I"},{score:19840,initials:"A L"},{score:19790,initials:"M T"},{score:19700,initials:"E O"},{score:19660,initials:"S N"},{score:190,initials:"   "},{score:70,initials:"   "}],s="jph_asteroids_hs",r=function(){function t(){this.scores=[];var t=window.localStorage.getItem(s);this.scores=t?JSON.parse(t)||[]:i}return Object.defineProperty(t.prototype,"top",{get:function(){return this.scores[0]},enumerable:!0,configurable:!0}),t.prototype.qualifies=function(t){var i=e.highscores.scores.filter(function(e){return e.score<t});return!!i.length},t.prototype.save=function(t,e){this.qualifies(t)&&(this.scores.push({score:t,initials:e}),this.scores=this.scores.sort(function(t,e){return t.score>e.score?-1:1}).slice(0,10),window.localStorage.setItem(s,JSON.stringify(this.scores)))},t}();e.highscores=new r},function(t,e,i){"use strict";var s=i(4),r=i(2),o=function(){function t(t){this.score=t,this.blink=0,this.showPushStart=!0,this.highscore=r.highscores.top.score}return t.prototype.update=function(t){this.blink+=t,this.blink>=.4&&(this.blink=0,this.showPushStart=!this.showPushStart)},t.prototype.render=function(){this.drawBackground(),this.drawPushStart(),this.drawHighScores()},t.prototype.drawBackground=function(){s.default.draw.background(),s.default.draw.scorePlayer1(this.score),s.default.draw.oneCoinOnePlay(),s.default.draw.highscore(this.highscore),s.default.draw.copyright()},t.prototype.drawHighScores=function(){var t=s.default.width/2;s.default.draw.text2("high scores","30pt",function(e){return{x:t-e/2,y:200}});for(var e=function(e){var o=280+40*e,n=i.pad(e+1," ",2)+"."+i.pad(r.highscores.scores[e].score," ",6)+" "+r.highscores.scores[e].initials;s.default.draw.text2(n,"30pt",function(e){return{x:t-e/2,y:o}})},i=this,o=0;o<r.highscores.scores.length;o++)e(o)},t.prototype.drawPushStart=function(){this.showPushStart&&s.default.draw.pushStart()},t.prototype.pad=function(t,e,i){for(t=t.toString();t.length<i;)t=e+t;return t},t}();e.HighScoreMode=o},function(t,e,i){"use strict";var s=i(5),r=function(){function t(){var t=this;this.x=0,this.y=0,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.draw=new s.Draw(this.ctx),this.init(),window.addEventListener("resize",function(){t.init()})}return t.prototype.init=function(){this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.width=this.canvas.width,this.height=this.canvas.height,this.width2=this.width/2,this.height2=this.height/2},t}();e.Screen=r,Object.defineProperty(e,"__esModule",{value:!0}),e.default=new r},function(t,e,i){"use strict";var s=i(4),r="rgba(255,255,255,1)",o=function(){function t(t){this.ctx=t}return t.prototype.line=function(t,e,i,s){void 0===i&&(i=r),void 0===s&&(s=2);var o=this.ctx;o.beginPath(),o.strokeStyle=i,o.lineWidth=s,o.moveTo(t.x,t.y),o.lineTo(e.x,e.y),o.stroke(),o.closePath()},t.prototype.shape=function(t,e,i,s){void 0===s&&(s=r);for(var o,n,h=0;h<t.length-1;h++)o={x:e+t[h].x,y:i+t[h].y},n={x:e+t[h+1].x,y:i+t[h+1].y},this.line(o,n,s,2)},t.prototype.rect=function(t,e,i){void 0===i&&(i=r);var s=this.ctx;s.beginPath(),s.fillStyle=i,s.fillRect(t.x,t.y,e.x,e.y),s.stroke(),s.closePath()},t.prototype.point=function(t,e){void 0===e&&(e=r),this.rect(t,{x:4,y:4},e)},t.prototype.background=function(){this.rect({x:0,y:0},{x:s.default.width,y:s.default.height},"#000000")},t.prototype.bounds=function(t,e){void 0===e&&(e=r);var i=this.ctx;t&&(i.save(),i.beginPath(),i.strokeStyle=e,i.lineWidth=2,i.moveTo(t.x,t.y),i.lineTo(t.x+t.width,t.y),i.lineTo(t.x+t.width,t.y+t.height),i.lineTo(t.x,t.y+t.height),i.lineTo(t.x,t.y),i.stroke(),i.closePath(),i.restore())},t.prototype.text=function(t,e,i,s){var o=this.ctx;o.save(),o.font=s+" hyperspace",o.textBaseline="middle",o.lineWidth=1,o.strokeStyle=r,o.strokeText(t,e,i),o.restore()},t.prototype.text2=function(t,e,i){var s=this.ctx;s.save(),s.font=e+" hyperspace",s.textBaseline="middle",s.lineWidth=1,s.strokeStyle=r;var o=s.measureText(t).width,n=i(o);s.strokeText(t,n.x,n.y),s.restore()},t.prototype.text3=function(t,e,i){var s=this.ctx;s.save(),s.font=e+" hyperspace",s.textBaseline="middle",s.lineWidth=2,s.fillStyle=r;var o=s.measureText(t).width,n=i(o);s.fillText(t,n.x,n.y),s.restore()},t.prototype.scorePlayer1=function(t){for(var e=t.toString();e.length<2;)e="0"+e;this.text(e,100,20,"24pt")},t.prototype.highscore=function(t){for(var e=t.toString();e.length<2;)e="0"+e;this.text2(e,"12pt",function(t){return{x:s.default.width2-t/2,y:20}})},t.prototype.oneCoinOnePlay=function(){this.text2("1  coin  1  play","24pt",function(t){return{x:s.default.width2-t/2,y:s.default.height-120}})},t.prototype.pushStart=function(){s.default.draw.text2("push start","30pt",function(t){return{x:s.default.width2-t/2,y:120}})},t.prototype.player1=function(){s.default.draw.text2("player 1","30pt",function(t){return{x:s.default.width2-t/2,y:140}})},t.prototype.gameOver=function(){s.default.draw.text2("game over","30pt",function(t){return{x:s.default.width2-t/2,y:180}})},t.prototype.copyright=function(){this.text2(String.fromCharCode(169)+" 1979 atari inc","12pt",function(t){return{x:s.default.width2-t/2,y:s.default.height-20}})},t}();e.Draw=o},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(4),o=i(7),n=i(2),h=i(8),a="_abcdefghijklmnopqrstuvwxyz",u=function(t){function e(e){var i=t.call(this)||this;return i.index=1,i.score=e,i.init(),i}return s(e,t),e.prototype.init=function(){this.position=0,this.index=1,this.initials=["a","_","_"]},e.prototype.update=function(t){o.Key.isPressed(o.Key.LEFT)&&(this.index--,this.index<0&&(this.index=a.length-1),this.initials[this.position]=a[this.index]),o.Key.isPressed(o.Key.RIGHT)&&(this.index++,this.index>a.length-1&&(this.index=0),this.initials[this.position]=a[this.index]),o.Key.isPressed(o.Key.SPACE)&&(this.position++,this.position>=3&&(console.log(this.score,this.initials.join("")),n.highscores.save(this.score,this.initials.join("")),this.init(),this.trigger("done")),this.index=1,this.initials[this.position]=a[this.index])},e.prototype.render=function(){var t=165,e=function(e){return r.default.draw.text(e,50,t+=35,"30pt")};r.default.draw.background(),r.default.draw.highscore(n.highscores.top.score),r.default.draw.scorePlayer1(this.score),r.default.draw.copyright(),e("your score is one of the ten best"),e("please enter your initials"),e("push rotate to select letter"),e("push hyperspace when letter is correct"),r.default.draw.text3(this.initials.join(""),"60pt",function(t){return{x:r.default.width/2-t,y:r.default.height/2}})},e}(h.EventSource);e.InitialsMode=u},function(t,e){"use strict";var i=222,s=function(){function t(){var t=this;this.SPACE=32,this.LEFT=37,this.UP=38,this.RIGHT=39,this.SHIFT=16,this.CTRL=17,this.ONE=49,this.DEBUG=68,this.PAUSE=80,this.keys=new Array(i),this.prev=new Array(i);for(var e=0;e<i;e++)this.keys[e]=this.prev[e]=!1;window.onkeydown=function(e){t.keys[e.keyCode]=!0},window.onkeyup=function(e){t.keys[e.keyCode]=!1}}return t.prototype.update=function(){for(var t=0;t<i;t++)this.prev[t]=this.keys[t]},t.prototype.isPressed=function(t){return this.prev[t]===!1&&this.keys[t]===!0},t.prototype.wasPressed=function(t){return this.prev[t]&&!this.keys[t]},t.prototype.isDown=function(t){return this.keys[t]},t}();e._Key=s,e.Key=new s},function(t,e){"use strict";var i=function(){function t(){this.handlers={}}return t.prototype.on=function(t,e){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},t.prototype.off=function(t,e){this.handlers[t]=this.handlers[t].filter(function(t){return t!==e})},t.prototype.trigger=function(t){for(var e=this,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var r=this.handlers[t]||[];r.forEach(function(t){return t.apply(void 0,[e].concat(i))})},t}();e.EventSource=i},function(t,e,i){"use strict";var s=i(4),r=i(10),o=function(){function t(t){this.state=t,this.showPushStart=!0,this.pushStartTimer=0,this.init()}return t.prototype.init=function(){this.state.started||this.state.startLevel()},t.prototype.update=function(t){this.state.levelTimer+=t,this.state.updateAlienTimer(t),this.state.rocks.length||this.state.explosions.length||this.state.alien||this.state.startLevel(),this.updatePushStartTimer(t),this.checkCollisions(),this.state.objects.forEach(function(e){e&&e.update(t)})},t.prototype.updatePushStartTimer=function(t){this.pushStartTimer+=t,this.pushStartTimer>=.4&&(this.pushStartTimer=0,this.showPushStart=!this.showPushStart)},t.prototype.checkCollisions=function(){var t=this,e=this.state,i=e.alien,s=e.rocks,o=e.alienBullets,n=!!i||!!o.length;if(n){var h=new r.Collisions;h.check([i],s,function(e,i){t.state.alienDestroyed(),t.state.rockDestroyed(i)}),h.check(o,s,function(e,i){t.state.rockDestroyed(i)})}},t.prototype.render=function(){this.drawBackground(),this.drawPushStart(),this.state.objects.forEach(function(t){t&&t.render()})},t.prototype.drawBackground=function(){s.default.draw.background(),s.default.draw.scorePlayer1(this.state.score),s.default.draw.oneCoinOnePlay(),s.default.draw.highscore(this.state.highscore),s.default.draw.copyright()},t.prototype.drawPushStart=function(){this.showPushStart&&s.default.draw.pushStart()},t}();e.AttractMode=o},function(t,e,i){"use strict";var s=i(4),r=i(11),o=function(){function t(){this.tree=new r.Quadtree({x:0,y:0,width:s.default.width,height:s.default.height},1)}return t.prototype.check=function(t,e,i,s){var r=this;t&&t.length&&e&&e.length&&(this.tree.clear(),e.forEach(function(t){r.tree.insert(t)}),t.forEach(function(t){var e=[];e.push.apply(e,r.tree.retrieve(t)),e.forEach(function(e){e.collided(t)?r.pointsInPolygon(t,e)&&i(t,e):s&&s(t,e)})}))},t.prototype.pointsInPolygon=function(t,e){for(var i=t.vertices,s=e.vertices,r=0,o=s.length;r<o;r++)if(this.pointInPoly(i,s[r]))return!0;return!1},t.prototype.pointInPoly=function(t,e){for(var i=t.length-1,s=0,r=0,o=t.length;r<o;r++)(t[r].y<e.y&&t[i].y>=e.y||t[i].y<e.y&&t[r].y>=e.y)&&(t[r].x<=e.x||t[i].x<=e.x)&&(s^=t[r].x+(e.y-t[r].y)/(t[i].y-t[r].y)*(t[i].x-t[r].x)<e.x),i=r;return s%2===0},t}();e.Collisions=o},function(t,e){"use strict";var i=function(){function t(t,e,i,s){void 0===e&&(e=10),void 0===i&&(i=4),void 0===s&&(s=0),this.bounds=t,this.maxObjects=e,this.maxLevels=i,this.level=s,this.objects=[],this.nodes=[],this.width2=this.bounds.width/2,this.height2=this.bounds.height/2,this.xmid=this.bounds.x+this.width2,this.ymid=this.bounds.y+this.height2}return t.prototype.insert=function(t){var e=this;if(t){var i,s=0;if(this.nodes.length&&(i=this.getIndex(t),i.length))return void i.forEach(function(i){e.nodes[i].insert(t)});if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels){this.nodes.length||this.split();for(var r=function(){if(i=o.getIndex(o.objects[s]),i.length){var t=o.objects.splice(s,1)[0];i.forEach(function(i){e.nodes[i].insert(t)})}else s+=1},o=this;s<this.objects.length;)r()}}},t.prototype.retrieve=function(t){var e=this;if(!t)return[];var i=this.getIndex(t),s=this.objects;if(this.nodes.length)if(i.length)i.forEach(function(i){s=s.concat(e.nodes[i].retrieve(t))});else for(var r=0;r<this.nodes.length;r++)s=s.concat(this.nodes[r].retrieve(t));return s.filter(function(t,e,i){return i.indexOf(t)===e})},t.prototype.clear=function(){this.objects=[];for(var t=0;t<this.nodes.length;t++)this.nodes[t]&&this.nodes[t].clear();this.nodes=[]},t.prototype.getIndex=function(t){if(!t)return[];var e=[],i=this,s=i.xmid,r=i.ymid,o=t.y<=r,n=t.y>r;if(t.x<=s)if(o){e.push(1);var h=!1;t.x+t.width>s&&(e.push(0),h=!0),t.y+t.height>r&&(e.push(2),h&&e.push(3))}else n&&(e.push(2),t.x+t.width>s&&e.push(3));else t.x>s&&(o?(e.push(0),t.y+t.height>r&&e.push(3)):e.push(3));return e},t.prototype.split=function(){var e=this,i=Math.round(this.width2),s=Math.round(this.height2),r=Math.round(this.bounds.x),o=Math.round(this.bounds.y),n=function(r,o){var n={x:r,y:o,width:i,height:s};return new t(n,e.maxObjects,e.maxLevels,e.level+1)};this.nodes=[n(r+i,o),n(r,o),n(r,o+s),n(r+i,o+s)]},t}();e.Quadtree=i},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(7),o=i(8),n=i(10),h=i(4),a=function(t){function e(e){var i=t.call(this)||this;return i.state=e,i.debug=!1,i.bounds=[],i}return s(e,t),e.prototype.init=function(){this.state.addShip(h.default.width2,h.default.height2),this.state.startLevel()},e.prototype.update=function(t){if(r.Key.isPressed(r.Key.DEBUG)&&(this.debug=!this.debug),r.Key.isPressed(r.Key.PAUSE)&&(this.state.paused=!this.state.paused),r.Key.isPressed(r.Key.SPACE)&&this.state.hyperspace(),!this.state.paused){if(this.state.levelTimer+=t,this.state.gameOver&&(this.state.gameOverTimer+=t,this.state.gameOverTimer>=5&&this.trigger("done",this.state)),!this.state.started)return void(this.state.levelTimer>=2&&(this.init(),this.state.started=!0));this.state.updateAlienTimer(t),this.state.gameOver||(this.state.shouldTryToPlaceShip()&&this.state.tryPlaceShip(t),this.state.shouldCheckForNextLevel()&&this.state.startLevel()),this.state.lives||(this.state.gameOver=!0),this.checkCollisions(),this.state.objects.forEach(function(e){e&&e.update(t)})}},e.prototype.render=function(t){this.renderStatic(),this.state.objects.forEach(function(t){t&&t.render()})},e.prototype.renderStatic=function(){h.default.draw.background(),h.default.draw.copyright(),h.default.draw.scorePlayer1(this.state.score),h.default.draw.highscore(this.state.highscore),this.state.drawExtraLives(),this.state.started||h.default.draw.player1(),this.state.gameOver&&h.default.draw.gameOver(),this.debug&&this.renderDebug()},e.prototype.renderDebug=function(){if(h.default.draw.text2("debug mode","12pt",function(t){return{x:h.default.width-t-10,y:h.default.height-40}}),this.bounds&&this.bounds.forEach(function(t){h.default.draw.bounds(t,"#fc058d")}),!this.state.ship&&this.state.lives){var t={x:h.default.width2-120,y:h.default.height2-120,width:240,height:240};h.default.draw.bounds(t,"#00ff00")}this.state.ship&&h.default.draw.text(this.state.ship.angle.toString(),this.state.ship.origin.x+20,this.state.ship.origin.y+20,"10pt");var e=new Date(null);e.setSeconds(this.state.levelTimer),h.default.draw.text2(e.toISOString().substr(11,8),"12pt",function(t){return{x:10,y:h.default.height-40}})},e.prototype.checkCollisions=function(){var t=this,e=this.state,i=e.ship,s=e.rocks,r=e.shipBullets,o=e.alien,h=e.alienBullets;if(this.state.shouldCheckCollisions()){this.bounds=[];var a=new n.Collisions;a.check([i],s,function(e,i){t.state.addScore(i.score),t.state.rockDestroyed(i),t.state.shipDestroyed()},function(e,i){t.debug&&t.bounds.push(i)}),a.check(r,s,function(e,i){t.state.addScore(i.score),t.state.rockDestroyed(i),e.destroy()},function(e,i){t.debug&&t.bounds.push(i)}),a.check(r,[o],function(e,i){t.state.addScore(i.score),t.state.alienDestroyed(),e.destroy()},function(e,i){t.debug&&t.bounds.push(i)}),a.check([i],[o],function(e,i){t.state.addScore(i.score),t.state.alienDestroyed(),t.state.shipDestroyed()},function(e,i){t.debug&&t.bounds.push(i)}),a.check(h,s,function(e,i){t.state.rockDestroyed(i)},function(e,i){t.debug&&t.bounds.push(i)}),a.check(h,[i],function(e,i){t.state.shipDestroyed(),e.destroy()},function(e,i){t.debug&&t.bounds.push(i)}),a.check([o],s,function(e,i){t.state.alienDestroyed(),t.state.rockDestroyed(i)},function(e,i){t.debug&&t.bounds.push(i)})}},e}(o.EventSource);e.GameMode=a},function(t,e,i){"use strict";var s=i(14),r=i(19),o=i(21),n=i(22),h=i(17),a=i(20),u=i(4),c=function(){function t(t){this.level=0,this.extraLifeScore=0,this.score=0,this.lives=3,this.shipBullets=[],this.alienBullets=[],this.explosions=[],this.rocks=[],this.shipTimer=0,this.alienTimer=0,this.levelTimer=0,this.gameOverTimer=0,this.gameOver=!1,this.started=!1,this.paused=!1,this.highscore=t}return Object.defineProperty(t.prototype,"objects",{get:function(){return[this.ship,this.alien].concat(this.shipBullets,this.alienBullets,this.rocks,this.explosions)},enumerable:!0,configurable:!0}),t.prototype.startLevel=function(){this.level++,this.levelTimer=0,this.alienTimer=a.random(10,15),this.addRocks()},t.prototype.addRocks=function(){for(var t=Math.min(this.level+3,7),e=150,i=0;i<t;i++){var s=a.random(1,4),r=new h.Vector(a.random(1,360)),o=void 0,c=void 0;switch(s){case 1:o=a.random(40,u.default.width-40),c=a.random(40,80);break;case 2:o=a.random(u.default.width-80,u.default.width-40),c=a.random(u.default.height-40,u.default.height-40);break;case 3:o=a.random(40,u.default.width-40),c=a.random(u.default.height-40,u.default.height-40);break;default:o=a.random(40,80),c=a.random(u.default.height-40,u.default.height-40)}var l=new n.Rock(o,c,r,n.RockSize.Large,e);this.rocks.push(l)}},t.prototype.addShip=function(t,e){var i=this;this.ship=new s.Ship(t,e),this.ship.on("fire",function(t,e){e.on("expired",function(){i.shipBullets=i.shipBullets.filter(function(t){return t!==e})}),i.shipBullets.push(e)})},t.prototype.createExplosion=function(t,e){var i=this,s=new o.Explosion(t,e);s.on("expired",function(){i.explosions=i.explosions.filter(function(t){return t!==s})}),this.explosions.push(s)},t.prototype.shipDestroyed=function(){this.createExplosion(this.ship.origin.x,this.ship.origin.y),this.lives--,this.ship=null,this.shipBullets=[]},t.prototype.alienDestroyed=function(){this.createExplosion(this.alien.origin.x,this.alien.origin.y),this.alien=null,this.alienBullets=[]},t.prototype.rockDestroyed=function(t){this.createExplosion(t.origin.x,t.origin.y),this.rocks=this.rocks.filter(function(e){return e!==t}),(e=this.rocks).push.apply(e,t.split()),t=null;var e},t.prototype.addAlien=function(){var t=this,e=Math.min(this.level,7);this.score>4e4?this.alien=new r.SmallAlien(this.ship):1===e?this.levelTimer<90?this.alien=new r.BigAlien:a.random(1,3)%2===0?this.alien=new r.SmallAlien(this.ship):this.alien=new r.BigAlien:this.alien=new r.BigAlien,this.alien.on("expired",function(){t.alien.destroy(),t.alien=null,t.alienBullets.forEach(function(t){return t.destroy()}),t.alienBullets=[]}),this.alien.on("fire",function(e,i){i.on("expired",function(){t.alienBullets=t.alienBullets.filter(function(t){return t!==i})}),t.alienBullets.push(i)})},t.prototype.hyperspace=function(){var t=a.random(40,u.default.width-40),e=a.random(40,u.default.height-40),i=this.ship.angle;this.addShip(t,e),this.ship.angle>i?i=-(this.ship.angle-i):this.ship.angle<i&&(i-=this.ship.angle),this.ship.rotate(i)},t.prototype.drawExtraLives=function(){for(var t=Math.min(this.lives,10),e=new s.Ship(0,0),i=0;i<t;i++)e.origin.x=80+20*i,e.origin.y=55,e.render()},t.prototype.addScore=function(t){this.score+=t,this.extraLifeScore+=t,this.score>this.highscore&&(this.highscore=this.score),this.extraLifeScore>=1e4&&(this.lives++,this.extraLifeScore=0)},t.prototype.tryPlaceShip=function(t){if(this.shipTimer+=t,!(this.shipTimer<=2)){var e={x:u.default.width2-120,y:u.default.height2-120,width:240,height:240},i=!1;this.rocks.forEach(function(t){i=i||t.collided(e)}),this.alien&&(i=i||this.alien.collided(e)),i||(this.shipTimer=0,this.addShip(u.default.width2,u.default.height2))}},t.prototype.updateAlienTimer=function(t){this.alien||(this.alienTimer-=t,this.alienTimer<=0&&(this.addAlien(),this.alienTimer=a.random(10,15)))},t.prototype.shouldTryToPlaceShip=function(){return!!this.shipTimer||!this.ship&&this.lives&&!this.explosions.length},t.prototype.shouldCheckForNextLevel=function(){return!this.rocks.length&&this.lives&&!this.explosions.length&&!this.alien},t.prototype.shouldCheckCollisions=function(){return!!(this.ship||this.shipBullets.length||this.alien||this.alienBullets.length)},t}();e.State=c},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(4),o=i(7),n=i(15),h=i(17),a=i(18),u=.1,c=800,l=.1,d=.007,p=5,f=1100,y=4,g=100,v=function(t){function e(e,i){var s=t.call(this,e,i)||this;return s.points=[{x:5,y:8},{x:0,y:20},{x:-5,y:8}],s}return s(e,t),e.prototype.update=function(){},e.prototype.render=function(){this.draw()},e}(n.Object2D),x=function(t){function e(e,i){var s=t.call(this,e,i)||this;return s.moving=!1,s.bulletCount=0,s.bulletTimer=0,s.flame=new v(e,i),s.points=[{x:0,y:-15},{x:10,y:10},{x:5,y:5},{x:-5,y:5},{x:-10,y:10},{x:0,y:-15}],s.angle=270,s}return s(e,t),e.prototype.render=function(){r.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color),this.moving&&(Math.floor(10*Math.random())+1)%2===0&&this.flame.draw()},e.prototype.update=function(t){this.move(t),this.flame.move(t),o.Key.isDown(o.Key.UP)?(this.moving=!0,this.thrust()):this.moving=!1,o.Key.isPressed(o.Key.LEFT)&&this.rotate(-1),o.Key.isDown(o.Key.LEFT)&&this.rotate(-p),o.Key.isPressed(o.Key.RIGHT)&&this.rotate(1),o.Key.isDown(o.Key.RIGHT)&&this.rotate(p),o.Key.isDown(o.Key.CTRL)&&this.fire(),this.bulletTimer>0&&(this.bulletTimer-=t),this.moving||(this.vx-=this.vx*d,this.vy-=this.vy*d,this.flame.vx=this.vx,this.flame.vy=this.vy)},e.prototype.rotate=function(e){t.prototype.rotate.call(this,e),this.flame.rotate(e)},e.prototype.thrust=function(){var t=new h.Vector(this.angle,g*u),e=this.magnitude;e<f&&(this.vx+=t.x,this.flame.vx=this.vx,this.vy+=t.y,this.flame.vy=this.vy)},e.prototype.fire=function(){var t=this;if(this.bulletTimer<=0&&this.bulletCount<y){this.bulletTimer=l,this.bulletCount++;var e=new h.Vector(this.angle),i=new a.Bullet(this.origin.x,this.origin.y,e);i.life=1,i.on("expired",function(){t.bulletCount--}),i.origin.x+=20*i.vx,i.origin.y+=20*i.vy;var s=0,r=this.vx*i.vx+this.vy*i.vy;r>0&&(s=this.magnitude),s=Math.max(c,s+c),i.vx*=s,i.vy*=s,this.trigger("fire",i)}},e}(n.Object2D);e.Ship=x},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(4),o=i(8),n=i(16),h=function(t){function e(e,i){var s=t.call(this)||this;return s.color="rgba(255,255,255,.9)",s.angle=360,s.vx=0,s.vy=0,s._xmin=0,s._xmax=0,s._ymin=0,s._ymax=0,s._width=0,s._height=0,s.origin={x:e,y:i},s}return s(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t,this.calcBounds()},enumerable:!0,configurable:!0}),e.prototype.calcBounds=function(){var t=this;this._points.forEach(function(e){e.x<t._xmin&&(t._xmin=e.x),e.x>t._xmax&&(t._xmax=e.x),e.y<t._ymin&&(t._ymin=e.y),e.y>t._ymax&&(t._ymax=e.y)}),this._width=this._xmax-this._xmin,this._height=this._ymax-this._ymin},e.prototype.rotate=function(t){this.angle+=t,this.angle<1&&(this.angle+=360),this.angle>360&&(this.angle-=360);var e=n.COS[t],i=n.SIN[t];this.points.forEach(function(t){var s=e*t.x-i*t.y,r=i*t.x+e*t.y;t.x=s,t.y=r}),this.calcBounds()},e.prototype.move=function(t){t=t?t:1,this.origin.x+=this.vx*t,this.origin.y+=this.vy*t,this.origin.x>r.default.width&&(this.origin.x-=r.default.width),this.origin.x<0&&(this.origin.x+=r.default.width),this.origin.y>r.default.height&&(this.origin.y-=r.default.height),this.origin.y<0&&(this.origin.y+=r.default.height)},e.prototype.scale=function(t){this.points.forEach(function(e){e.x*=t,e.y*=t}),this.calcBounds()},e.prototype.draw=function(){r.default.draw.shape(this.points,this.origin.x,this.origin.y,this.color)},Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.origin.x+this._xmin},set:function(t){this.origin.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.origin.y+this._ymin},set:function(t){this.origin.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertices",{get:function(){var t=this;return this.points.map(function(e){return{x:t.origin.x+e.x,y:t.origin.y+e.y}})},enumerable:!0,configurable:!0}),e.prototype.collided=function(t){return!!(t&&this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.height+this.y>t.y)},e.prototype.destroy=function(){for(var t in this.handlers)this.handlers[t]=null;this.handlers={}},e}(o.EventSource);e.Object2D=h},function(t,e){"use strict";var i={};e.RAD=i;var s={};e.COS=s;var r={};e.SIN=r;for(var o=Math.PI/180,n=0;n<=360;n++)i[n]=n*o,s[n]=Math.cos(i[n]),r[n]=Math.sin(i[n]),i[-n]=-n*o,s[-n]=Math.cos(i[-n]),r[-n]=Math.sin(i[-n])},function(t,e){"use strict";for(var i={},s=2*Math.PI,r=0;r<=360;r++){var o=s*(r/360);i[r]={x:Math.cos(o),y:Math.sin(o)}}var n=function(){function t(t,e){void 0===e&&(e=1),this.x=i[t].x*e,this.y=i[t].y*e}return t.fromXY=function(e,i,s){void 0===s&&(s=1);var r=e.x-i.x,o=e.y-i.y,n=Math.sqrt(r*r+o*o);r/=n,o/=n;var h=new t(0);return h.x=r*s,h.y=o*s,h},t}();e.Vector=n},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(4),o=i(15),n=function(t){function e(e,i,s){var r=t.call(this,e,i)||this;return r.life=1.25,r.vx=s.x,r.vy=s.y,r}return s(e,t),e.prototype.render=function(){this.draw()},e.prototype.update=function(t){this.move(t),this.life-=t,this.life<=0&&(this.trigger("expired"),this.destroy())},e.prototype.draw=function(){r.default.draw.point({x:this.origin.x,y:this.origin.y})},e.prototype.destroy=function(){this.life=0,this.trigger("expire")},Object.defineProperty(e.prototype,"vertices",{get:function(){return[this.origin]},enumerable:!0,configurable:!0}),e}(o.Object2D);e.Bullet=n},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(4),o=i(20),n=i(15),h=i(18),a=i(17),u=600,c=225,l=250,d=function(t){function e(e){var i=t.call(this,0,0)||this;return i.moveTimer=0,i.moveTime=1,i.bulletTimer=0,i.bulletTime=.7,i.vy=0,i.origin.y=o.random(100,r.default.height-100),i.origin.y%2===0?(i.origin.x=40,i.vx=e):(i.origin.x=r.default.width-40,i.vx=-e),i.points=[{x:.5,y:-2},{x:1,y:-1},{x:2.5,y:0},{x:1,y:1},{x:-1,y:1},{x:-2.5,y:0},{x:-1,y:-1},{x:-.5,y:-2},{x:.5,y:-2}],i}return s(e,t),e.prototype.update=function(t){if(this.move(t),this.origin.x>=r.default.width-5||this.origin.x<=5)return void this.trigger("expired");if(this.moveTimer+=t,this.moveTimer>=1&&0!==this.vy&&(this.vy=0,this.moveTimer=0),this.moveTimer>=this.moveTime){var e=o.random(1,20)%2===0;e&&(this.vy=this.origin.x%2===0?this.vx:-this.vx),this.moveTimer=0}this.bulletTimer+=t,this.bulletTimer>=this.bulletTime&&(this.fire(),this.bulletTimer=0)},e.prototype.render=function(){this.draw()},e.prototype.draw=function(){t.prototype.draw.call(this),r.default.draw.shape([this.points[1],this.points[6]],this.origin.x,this.origin.y),r.default.draw.shape([this.points[2],this.points[5]],this.origin.x,this.origin.y)},e}(n.Object2D);e.Alien=d;var p=function(t){function e(){var e=t.call(this,c)||this;return e.score=200,e.scale(7),e}return s(e,t),e.prototype.fire=function(){var t=new a.Vector(o.random(1,360),u),e=new h.Bullet(this.origin.x,this.origin.y,t);this.trigger("fire",e)},e.prototype.destroy=function(){},e}(d);e.BigAlien=p;var f=function(t){function e(e){var i=t.call(this,l)||this;return i.ship=e,i.score=1e3,i.bulletTime=1,i.scale(4),i}return s(e,t),e.prototype.fire=function(){var t;if(this.ship){var e=a.Vector.fromXY(this.ship.origin,this.origin,u);t=new h.Bullet(this.origin.x,this.origin.y,e)}else{var e=new a.Vector(o.random(1,360),u);t=new h.Bullet(this.origin.x,this.origin.y,e)}this.trigger("fire",t)},e.prototype.destroy=function(){this.ship=null},e}(d);e.SmallAlien=f},function(t,e){"use strict";function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}e.random=i},function(t,e,i){"use strict";var s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=i(8),o=i(4),n=i(17),h=i(20),a=150,u=function(t){function e(e,i){var s=t.call(this)||this;s.life=1.25,s.points=[];for(var r=0;r<15;r++){var o=new n.Vector(h.random(1,360),Math.random()*a);s.points.push({x:e,y:i,vx:o.x,vy:o.y})}return s}return s(e,t),e.prototype.update=function(t){this.points.forEach(function(e){e.x+=e.vx*t,e.y+=e.vy*t}),this.life-=t,this.life<=0&&this.trigger("expired")},e.prototype.render=function(t){var e=this;this.points.forEach(function(t){o.default.draw.point(t,"rgba(255,255,255,"+e.life+")")})},e}(r.EventSource);e.Explosion=u},function(t,e,i){"use strict";var s,r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(15),n=i(17),h=i(20);!function(t){t[t.Small=5]="Small",t[t.Medium=10]="Medium",t[t.Large=20]="Large"}(s=e.RockSize||(e.RockSize={}));var a=function(t){function e(e,i,s,r,o){void 0===o&&(o=1);var n=t.call(this,e,i)||this;n.rotTimer=0,n.rock1=[[.5,-2],[2,-1],[2,-.7],[1.2,0],[2,1],[1,2],[.5,1.5],[-1,2],[-2,.7],[-2,-1],[-.5,-1],[-1,-2],[.5,-2]],n.rock2=[[0,-1.5],[1,-2],[2,-1],[1,-.5],[2,.5],[1,2],[-.5,1.5],[-1,2],[-2,1],[-1.5,0],[-2,-1],[-1,-2],[0,-1.5]],
n.rock3=[[0,-1],[1,-2],[2,-1],[1.5,0],[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[0,-1]],n.rocks=[n.rock1,n.rock2,n.rock3],n.vx=s.x*o,n.vy=s.y*o;var a=h.random(0,2),u=n.rocks[a];return n.points=u.map(function(t){return{x:t[0]*r,y:t[1]*r}}),n.size=r,n.rotate(h.random(1,90)),n.rot=h.random(.01,1)%2===0?1:-1,n.timeToRot=h.random(1,5),n}return r(e,t),e.prototype.update=function(t){this.rotTimer+=1,this.move(t),this.rotTimer===this.timeToRot&&(this.rotate(this.rot),this.rotTimer=0)},e.prototype.render=function(){this.draw()},Object.defineProperty(e.prototype,"direction",{get:function(){var t=Math.atan2(this.vy,this.vx),e=t*(180/Math.PI);return e=e>0?e:360+e,Math.floor(e)},enumerable:!0,configurable:!0}),e.prototype.split=function(){if(this.size>s.Small){var t=h.random(this.direction,this.direction+80),i=h.random(this.direction-80,this.direction);t<0&&(t+=360),t>360&&(t-=360),i<0&&(i+=360),i>360&&(i-=360);var r=this.size===s.Large?s.Medium:s.Small,o=new n.Vector(t),a=new n.Vector(i),u=r===s.Medium?h.random(150,250):h.random(250,350),c=r===s.Medium?h.random(150,250):h.random(250,350),l=new e(this.origin.x,this.origin.y,o,r,u),d=new e(this.origin.x,this.origin.y,a,r,c);return[l,d]}return[]},Object.defineProperty(e.prototype,"score",{get:function(){return this.size===s.Large?20:this.size===s.Medium?50:100},enumerable:!0,configurable:!0}),e}(o.Object2D);e.Rock=a}]);